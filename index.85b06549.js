var t=Math.sqrt(50),e=Math.sqrt(10),n=Math.sqrt(2);function i(t,e,n){var i,a,o,s,h=-1;if(n=+n,(t=+t)===(e=+e)&&n>0)return[t];if((i=e<t)&&(a=t,t=e,e=a),0===(s=r(t,e,n))||!isFinite(s))return[];if(s>0){let n=Math.round(t/s),i=Math.round(e/s);for(n*s<t&&++n,i*s>e&&--i,o=new Array(a=i-n+1);++h<a;)o[h]=(n+h)*s}else{s=-s;let n=Math.round(t*s),i=Math.round(e*s);for(n/s<t&&++n,i/s>e&&--i,o=new Array(a=i-n+1);++h<a;)o[h]=(n+h)/s}return i&&o.reverse(),o}function r(i,r,a){var o=(r-i)/Math.max(0,a),s=Math.floor(Math.log(o)/Math.LN10),h=o/Math.pow(10,s);return s>=0?(h>=t?10:h>=e?5:h>=n?2:1)*Math.pow(10,s):-Math.pow(10,-s)/(h>=t?10:h>=e?5:h>=n?2:1)}function a(i,r,a){var o=Math.abs(r-i)/Math.max(0,a),s=Math.pow(10,Math.floor(Math.log(o)/Math.LN10)),h=o/s;return h>=t?s*=10:h>=e?s*=5:h>=n&&(s*=2),r<i?-s:s}function o(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function s(t){let e=t,n=t;function i(t,e,i,r){for(null==i&&(i=0),null==r&&(r=t.length);i<r;){const a=i+r>>>1;n(t[a],e)<0?i=a+1:r=a}return i}return 1===t.length&&(e=(e,n)=>t(e)-n,n=function(t){return(e,n)=>o(t(e),n)}(t)),{left:i,center:function(t,n,r,a){null==r&&(r=0),null==a&&(a=t.length);const o=i(t,n,r,a-1);return o>r&&e(t[o-1],n)>-e(t[o],n)?o-1:o},right:function(t,e,i,r){for(null==i&&(i=0),null==r&&(r=t.length);i<r;){const a=i+r>>>1;n(t[a],e)>0?r=a:i=a+1}return i}}}const h=s(o),l=h.right;h.left,s((function(t){return null===t?NaN:+t})).center;var u=l;function c(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function d(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function p(){}var f=.7,g=1.4285714285714286,v="\\s*([+-]?\\d+)\\s*",m="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",b="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",y=/^#([0-9a-f]{3,8})$/,w=new RegExp("^rgb\\("+[v,v,v]+"\\)$"),k=new RegExp("^rgb\\("+[b,b,b]+"\\)$"),x=new RegExp("^rgba\\("+[v,v,v,m]+"\\)$"),M=new RegExp("^rgba\\("+[b,b,b,m]+"\\)$"),N=new RegExp("^hsl\\("+[m,b,b]+"\\)$"),S=new RegExp("^hsla\\("+[m,b,b,m]+"\\)$"),C={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function E(){return this.rgb().formatHex()}function A(){return this.rgb().formatRgb()}function F(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=y.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?L(e):3===n?new P(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?H(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?H(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=w.exec(t))?new P(e[1],e[2],e[3],1):(e=k.exec(t))?new P(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=x.exec(t))?H(e[1],e[2],e[3],e[4]):(e=M.exec(t))?H(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=N.exec(t))?V(e[1],e[2]/100,e[3]/100,1):(e=S.exec(t))?V(e[1],e[2]/100,e[3]/100,e[4]):C.hasOwnProperty(t)?L(C[t]):"transparent"===t?new P(NaN,NaN,NaN,0):null}function L(t){return new P(t>>16&255,t>>8&255,255&t,1)}function H(t,e,n,i){return i<=0&&(t=e=n=NaN),new P(t,e,n,i)}function R(t,e,n,i){return 1===arguments.length?((r=t)instanceof p||(r=F(r)),r?new P((r=r.rgb()).r,r.g,r.b,r.opacity):new P):new P(t,e,n,null==i?1:i);var r}function P(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function I(){return"#"+q(this.r)+q(this.g)+q(this.b)}function $(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function q(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function V(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new U(t,e,n,i)}function z(t){if(t instanceof U)return new U(t.h,t.s,t.l,t.opacity);if(t instanceof p||(t=F(t)),!t)return new U;if(t instanceof U)return t;var e=(t=t.rgb()).r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),a=Math.max(e,n,i),o=NaN,s=a-r,h=(a+r)/2;return s?(o=e===a?(n-i)/s+6*(n<i):n===a?(i-e)/s+2:(e-n)/s+4,s/=h<.5?a+r:2-a-r,o*=60):s=h>0&&h<1?0:o,new U(o,s,h,t.opacity)}function U(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function T(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function B(t,e,n,i,r){var a=t*t,o=a*t;return((1-3*t+3*a-o)*e+(4-6*a+3*o)*n+(1+3*t+3*a-3*o)*i+o*r)/6}c(p,F,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:E,formatHex:E,formatHsl:function(){return z(this).formatHsl()},formatRgb:A,toString:A}),c(P,R,d(p,{brighter:function(t){return t=null==t?g:Math.pow(g,t),new P(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?f:Math.pow(f,t),new P(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:I,formatHex:I,formatRgb:$,toString:$})),c(U,(function(t,e,n,i){return 1===arguments.length?z(t):new U(t,e,n,null==i?1:i)}),d(p,{brighter:function(t){return t=null==t?g:Math.pow(g,t),new U(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?f:Math.pow(f,t),new U(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new P(T(t>=240?t-240:t+120,r,i),T(t,r,i),T(t<120?t+240:t-120,r,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var X=t=>()=>t;function G(t,e){return function(n){return t+n*e}}function j(t){return 1==(t=+t)?O:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}(e,n,t):X(isNaN(e)?n:e)}}function O(t,e){var n=e-t;return n?G(t,n):X(isNaN(t)?e:t)}var Y=function t(e){var n=j(e);function i(t,e){var i=n((t=R(t)).r,(e=R(e)).r),r=n(t.g,e.g),a=n(t.b,e.b),o=O(t.opacity,e.opacity);return function(e){return t.r=i(e),t.g=r(e),t.b=a(e),t.opacity=o(e),t+""}}return i.gamma=t,i}(1);function D(t){return function(e){var n,i,r=e.length,a=new Array(r),o=new Array(r),s=new Array(r);for(n=0;n<r;++n)i=R(e[n]),a[n]=i.r||0,o[n]=i.g||0,s[n]=i.b||0;return a=t(a),o=t(o),s=t(s),i.opacity=1,function(t){return i.r=a(t),i.g=o(t),i.b=s(t),i+""}}}D((function(t){var e=t.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),r=t[i],a=t[i+1],o=i>0?t[i-1]:2*r-a,s=i<e-1?t[i+2]:2*a-r;return B((n-i/e)*e,o,r,a,s)}})),D((function(t){var e=t.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*e),r=t[(i+e-1)%e],a=t[i%e],o=t[(i+1)%e],s=t[(i+2)%e];return B((n-i/e)*e,r,a,o,s)}}));function Z(t,e){e||(e=[]);var n,i=t?Math.min(e.length,t.length):0,r=e.slice();return function(a){for(n=0;n<i;++n)r[n]=t[n]*(1-a)+e[n]*a;return r}}function _(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function W(t,e){var n,i=e?e.length:0,r=t?Math.min(i,t.length):0,a=new Array(r),o=new Array(i);for(n=0;n<r;++n)a[n]=it(t[n],e[n]);for(;n<i;++n)o[n]=e[n];return function(t){for(n=0;n<r;++n)o[n]=a[n](t);return o}}function J(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}}function K(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Q(t,e){var n,i={},r={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?i[n]=it(t[n],e[n]):r[n]=e[n];return function(t){for(n in i)r[n]=i[n](t);return r}}var tt=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,et=new RegExp(tt.source,"g");function nt(t,e){var n,i,r,a=tt.lastIndex=et.lastIndex=0,o=-1,s=[],h=[];for(t+="",e+="";(n=tt.exec(t))&&(i=et.exec(e));)(r=i.index)>a&&(r=e.slice(a,r),s[o]?s[o]+=r:s[++o]=r),(n=n[0])===(i=i[0])?s[o]?s[o]+=i:s[++o]=i:(s[++o]=null,h.push({i:o,x:K(n,i)})),a=et.lastIndex;return a<e.length&&(r=e.slice(a),s[o]?s[o]+=r:s[++o]=r),s.length<2?h[0]?function(t){return function(e){return t(e)+""}}(h[0].x):function(t){return function(){return t}}(e):(e=h.length,function(t){for(var n,i=0;i<e;++i)s[(n=h[i]).i]=n.x(t);return s.join("")})}function it(t,e){var n,i=typeof e;return null==e||"boolean"===i?X(e):("number"===i?K:"string"===i?(n=F(e))?(e=n,Y):nt:e instanceof F?Y:e instanceof Date?J:_(e)?Z:Array.isArray(e)?W:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?Q:K)(t,e)}function rt(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function at(t){return+t}var ot=[0,1];function st(t){return t}function ht(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function lt(t,e,n){var i=t[0],r=t[1],a=e[0],o=e[1];return r<i?(i=ht(r,i),a=n(o,a)):(i=ht(i,r),a=n(a,o)),function(t){return a(i(t))}}function ut(t,e,n){var i=Math.min(t.length,e.length)-1,r=new Array(i),a=new Array(i),o=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<i;)r[o]=ht(t[o],t[o+1]),a[o]=n(e[o],e[o+1]);return function(e){var n=u(t,e,1,i)-1;return a[n](r[n](e))}}function ct(){var t,e,n,i,r,a,o=ot,s=ot,h=it,l=st;function u(){var t,e,n,h=Math.min(o.length,s.length);return l!==st&&(t=o[0],e=o[h-1],t>e&&(n=t,t=e,e=n),l=function(n){return Math.max(t,Math.min(e,n))}),i=h>2?ut:lt,r=a=null,c}function c(e){return null==e||isNaN(e=+e)?n:(r||(r=i(o.map(t),s,h)))(t(l(e)))}return c.invert=function(n){return l(e((a||(a=i(s,o.map(t),K)))(n)))},c.domain=function(t){return arguments.length?(o=Array.from(t,at),u()):o.slice()},c.range=function(t){return arguments.length?(s=Array.from(t),u()):s.slice()},c.rangeRound=function(t){return s=Array.from(t),h=rt,u()},c.clamp=function(t){return arguments.length?(l=!!t||st,u()):l!==st},c.interpolate=function(t){return arguments.length?(h=t,u()):h},c.unknown=function(t){return arguments.length?(n=t,c):n},function(n,i){return t=n,e=i,u()}}function dt(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function pt(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function ft(t){return(t=pt(Math.abs(t)))?t[1]:NaN}function gt(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}var vt,mt=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function bt(t){if(!(e=mt.exec(t)))throw new Error("invalid format: "+t);var e;return new yt({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function yt(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function wt(t){t:for(var e,n=t.length,i=1,r=-1;i<n;++i)switch(t[i]){case".":r=e=i;break;case"0":0===r&&(r=i),e=i;break;default:if(!+t[i])break t;r>0&&(r=0)}return r>0?t.slice(0,r)+t.slice(e+1):t}function kt(t,e){var n=pt(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}bt.prototype=yt.prototype,yt.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var xt={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>kt(100*t,e),r:kt,s:function(t,e){var n=pt(t,e);if(!n)return t+"";var i=n[0],r=n[1],a=r-(vt=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,o=i.length;return a===o?i:a>o?i+new Array(a-o+1).join("0"):a>0?i.slice(0,a)+"."+i.slice(a):"0."+new Array(1-a).join("0")+pt(t,Math.max(0,e+a-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Mt(t){return t}var Nt,St,Ct,Et=Array.prototype.map,At=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Ft(t){var e,n,i=void 0===t.grouping||void 0===t.thousands?Mt:(e=Et.call(t.grouping,Number),n=t.thousands+"",function(t,i){for(var r=t.length,a=[],o=0,s=e[0],h=0;r>0&&s>0&&(h+s+1>i&&(s=Math.max(1,i-h)),a.push(t.substring(r-=s,r+s)),!((h+=s+1)>i));)s=e[o=(o+1)%e.length];return a.reverse().join(n)}),r=void 0===t.currency?"":t.currency[0]+"",a=void 0===t.currency?"":t.currency[1]+"",o=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?Mt:gt(Et.call(t.numerals,String)),h=void 0===t.percent?"%":t.percent+"",l=void 0===t.minus?"−":t.minus+"",u=void 0===t.nan?"NaN":t.nan+"";function c(t){var e=(t=bt(t)).fill,n=t.align,c=t.sign,d=t.symbol,p=t.zero,f=t.width,g=t.comma,v=t.precision,m=t.trim,b=t.type;"n"===b?(g=!0,b="g"):xt[b]||(void 0===v&&(v=12),m=!0,b="g"),(p||"0"===e&&"="===n)&&(p=!0,e="0",n="=");var y="$"===d?r:"#"===d&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",w="$"===d?a:/[%p]/.test(b)?h:"",k=xt[b],x=/[defgprs%]/.test(b);function M(t){var r,a,h,d=y,M=w;if("c"===b)M=k(t)+M,t="";else{var N=(t=+t)<0||1/t<0;if(t=isNaN(t)?u:k(Math.abs(t),v),m&&(t=wt(t)),N&&0==+t&&"+"!==c&&(N=!1),d=(N?"("===c?c:l:"-"===c||"("===c?"":c)+d,M=("s"===b?At[8+vt/3]:"")+M+(N&&"("===c?")":""),x)for(r=-1,a=t.length;++r<a;)if(48>(h=t.charCodeAt(r))||h>57){M=(46===h?o+t.slice(r+1):t.slice(r))+M,t=t.slice(0,r);break}}g&&!p&&(t=i(t,1/0));var S=d.length+t.length+M.length,C=S<f?new Array(f-S+1).join(e):"";switch(g&&p&&(t=i(C+t,C.length?f-M.length:1/0),C=""),n){case"<":t=d+t+M+C;break;case"=":t=d+C+t+M;break;case"^":t=C.slice(0,S=C.length>>1)+d+t+M+C.slice(S);break;default:t=C+d+t+M}return s(t)}return v=void 0===v?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v)),M.toString=function(){return t+""},M}return{format:c,formatPrefix:function(t,e){var n=c(((t=bt(t)).type="f",t)),i=3*Math.max(-8,Math.min(8,Math.floor(ft(e)/3))),r=Math.pow(10,-i),a=At[8+i/3];return function(t){return n(r*t)+a}}}}function Lt(t){return Math.max(0,-ft(Math.abs(t)))}function Ht(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(ft(e)/3)))-ft(Math.abs(t)))}function Rt(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,ft(e)-ft(t))+1}function Pt(t,e,n,i){var r,o=a(t,e,n);switch((i=bt(null==i?",f":i)).type){case"s":var s=Math.max(Math.abs(t),Math.abs(e));return null!=i.precision||isNaN(r=Ht(o,s))||(i.precision=r),Ct(i,s);case"":case"e":case"g":case"p":case"r":null!=i.precision||isNaN(r=Rt(o,Math.max(Math.abs(t),Math.abs(e))))||(i.precision=r-("e"===i.type));break;case"f":case"%":null!=i.precision||isNaN(r=Lt(o))||(i.precision=r-2*("%"===i.type))}return St(i)}function It(t){var e=t.domain;return t.ticks=function(t){var n=e();return i(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var i=e();return Pt(i[0],i[i.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var i,a,o=e(),s=0,h=o.length-1,l=o[s],u=o[h],c=10;for(u<l&&(a=l,l=u,u=a,a=s,s=h,h=a);c-- >0;){if((a=r(l,u,n))===i)return o[s]=l,o[h]=u,e(o);if(a>0)l=Math.floor(l/a)*a,u=Math.ceil(u/a)*a;else{if(!(a<0))break;l=Math.ceil(l*a)/a,u=Math.floor(u*a)/a}i=a}return t},t}function $t(){var t=ct()(st,st);return t.copy=function(){return e=t,$t().domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown());var e},dt.apply(t,arguments),It(t)}function qt(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Vt(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function zt(){}Nt=Ft({thousands:",",grouping:[3],currency:["$",""]}),St=Nt.format,Ct=Nt.formatPrefix;var Ut=.7,Tt=1.4285714285714286,Bt="\\s*([+-]?\\d+)\\s*",Xt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Gt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",jt=/^#([0-9a-f]{3,8})$/,Ot=new RegExp(`^rgb\\(${Bt},${Bt},${Bt}\\)$`),Yt=new RegExp(`^rgb\\(${Gt},${Gt},${Gt}\\)$`),Dt=new RegExp(`^rgba\\(${Bt},${Bt},${Bt},${Xt}\\)$`),Zt=new RegExp(`^rgba\\(${Gt},${Gt},${Gt},${Xt}\\)$`),_t=new RegExp(`^hsl\\(${Xt},${Gt},${Gt}\\)$`),Wt=new RegExp(`^hsla\\(${Xt},${Gt},${Gt},${Xt}\\)$`),Jt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Kt(){return this.rgb().formatHex()}function Qt(){return this.rgb().formatRgb()}function te(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=jt.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?ee(e):3===n?new re(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?ne(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?ne(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Ot.exec(t))?new re(e[1],e[2],e[3],1):(e=Yt.exec(t))?new re(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Dt.exec(t))?ne(e[1],e[2],e[3],e[4]):(e=Zt.exec(t))?ne(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=_t.exec(t))?ue(e[1],e[2]/100,e[3]/100,1):(e=Wt.exec(t))?ue(e[1],e[2]/100,e[3]/100,e[4]):Jt.hasOwnProperty(t)?ee(Jt[t]):"transparent"===t?new re(NaN,NaN,NaN,0):null}function ee(t){return new re(t>>16&255,t>>8&255,255&t,1)}function ne(t,e,n,i){return i<=0&&(t=e=n=NaN),new re(t,e,n,i)}function ie(t,e,n,i){return 1===arguments.length?((r=t)instanceof zt||(r=te(r)),r?new re((r=r.rgb()).r,r.g,r.b,r.opacity):new re):new re(t,e,n,null==i?1:i);var r}function re(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function ae(){return`#${le(this.r)}${le(this.g)}${le(this.b)}`}function oe(){const t=se(this.opacity);return`${1===t?"rgb(":"rgba("}${he(this.r)}, ${he(this.g)}, ${he(this.b)}${1===t?")":`, ${t})`}`}function se(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function he(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function le(t){return((t=he(t))<16?"0":"")+t.toString(16)}function ue(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new pe(t,e,n,i)}function ce(t){if(t instanceof pe)return new pe(t.h,t.s,t.l,t.opacity);if(t instanceof zt||(t=te(t)),!t)return new pe;if(t instanceof pe)return t;var e=(t=t.rgb()).r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),a=Math.max(e,n,i),o=NaN,s=a-r,h=(a+r)/2;return s?(o=e===a?(n-i)/s+6*(n<i):n===a?(i-e)/s+2:(e-n)/s+4,s/=h<.5?a+r:2-a-r,o*=60):s=h>0&&h<1?0:o,new pe(o,s,h,t.opacity)}function de(t,e,n,i){return 1===arguments.length?ce(t):new pe(t,e,n,null==i?1:i)}function pe(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function fe(t){return(t=(t||0)%360)<0?t+360:t}function ge(t){return Math.max(0,Math.min(1,t||0))}function ve(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}qt(zt,te,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Kt,formatHex:Kt,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return ce(this).formatHsl()},formatRgb:Qt,toString:Qt}),qt(re,ie,Vt(zt,{brighter(t){return t=null==t?Tt:Math.pow(Tt,t),new re(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?Ut:Math.pow(Ut,t),new re(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new re(he(this.r),he(this.g),he(this.b),se(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ae,formatHex:ae,formatHex8:function(){return`#${le(this.r)}${le(this.g)}${le(this.b)}${le(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:oe,toString:oe})),qt(pe,de,Vt(zt,{brighter(t){return t=null==t?Tt:Math.pow(Tt,t),new pe(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?Ut:Math.pow(Ut,t),new pe(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new re(ve(t>=240?t-240:t+120,r,i),ve(t,r,i),ve(t<120?t+240:t-120,r,i),this.opacity)},clamp(){return new pe(fe(this.h),ge(this.s),ge(this.l),se(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=se(this.opacity);return`${1===t?"hsl(":"hsla("}${fe(this.h)}, ${100*ge(this.s)}%, ${100*ge(this.l)}%${1===t?")":`, ${t})`}`}}));var me=t=>()=>t;function be(t,e){return function(n){return t+n*e}}function ye(t,e){var n=e-t;return n?be(t,n):me(isNaN(t)?e:t)}function we(t){return function(e,n){var i=t((e=de(e)).h,(n=de(n)).h),r=ye(e.s,n.s),a=ye(e.l,n.l),o=ye(e.opacity,n.opacity);return function(t){return e.h=i(t),e.s=r(t),e.l=a(t),e.opacity=o(t),e+""}}}we((function(t,e){var n=e-t;return n?be(t,n>180||n<-180?n-360*Math.round(n/360):n):me(isNaN(t)?e:t)}));var ke=we(ye);function xe(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Me(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Ne(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function Se(){}var Ce=.7,Ee=1.4285714285714286,Ae="\\s*([+-]?\\d+)\\s*",Fe="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Le="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",He=/^#([0-9a-f]{3,8})$/,Re=new RegExp("^rgb\\("+[Ae,Ae,Ae]+"\\)$"),Pe=new RegExp("^rgb\\("+[Le,Le,Le]+"\\)$"),Ie=new RegExp("^rgba\\("+[Ae,Ae,Ae,Fe]+"\\)$"),$e=new RegExp("^rgba\\("+[Le,Le,Le,Fe]+"\\)$"),qe=new RegExp("^hsl\\("+[Fe,Le,Le]+"\\)$"),Ve=new RegExp("^hsla\\("+[Fe,Le,Le,Fe]+"\\)$"),ze={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Ue(){return this.rgb().formatHex()}function Te(){return this.rgb().formatRgb()}function Be(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=He.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Xe(e):3===n?new Oe(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?Ge(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?Ge(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Re.exec(t))?new Oe(e[1],e[2],e[3],1):(e=Pe.exec(t))?new Oe(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Ie.exec(t))?Ge(e[1],e[2],e[3],e[4]):(e=$e.exec(t))?Ge(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=qe.exec(t))?_e(e[1],e[2]/100,e[3]/100,1):(e=Ve.exec(t))?_e(e[1],e[2]/100,e[3]/100,e[4]):ze.hasOwnProperty(t)?Xe(ze[t]):"transparent"===t?new Oe(NaN,NaN,NaN,0):null}function Xe(t){return new Oe(t>>16&255,t>>8&255,255&t,1)}function Ge(t,e,n,i){return i<=0&&(t=e=n=NaN),new Oe(t,e,n,i)}function je(t,e,n,i){return 1===arguments.length?((r=t)instanceof Se||(r=Be(r)),r?new Oe((r=r.rgb()).r,r.g,r.b,r.opacity):new Oe):new Oe(t,e,n,null==i?1:i);var r}function Oe(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function Ye(){return"#"+Ze(this.r)+Ze(this.g)+Ze(this.b)}function De(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function Ze(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function _e(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Je(t,e,n,i)}function We(t){if(t instanceof Je)return new Je(t.h,t.s,t.l,t.opacity);if(t instanceof Se||(t=Be(t)),!t)return new Je;if(t instanceof Je)return t;var e=(t=t.rgb()).r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),a=Math.max(e,n,i),o=NaN,s=a-r,h=(a+r)/2;return s?(o=e===a?(n-i)/s+6*(n<i):n===a?(i-e)/s+2:(e-n)/s+4,s/=h<.5?a+r:2-a-r,o*=60):s=h>0&&h<1?0:o,new Je(o,s,h,t.opacity)}function Je(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function Ke(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}Me(Se,Be,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:Ue,formatHex:Ue,formatHsl:function(){return We(this).formatHsl()},formatRgb:Te,toString:Te}),Me(Oe,je,Ne(Se,{brighter:function(t){return t=null==t?Ee:Math.pow(Ee,t),new Oe(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?Ce:Math.pow(Ce,t),new Oe(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ye,formatHex:Ye,formatRgb:De,toString:De})),Me(Je,(function(t,e,n,i){return 1===arguments.length?We(t):new Je(t,e,n,null==i?1:i)}),Ne(Se,{brighter:function(t){return t=null==t?Ee:Math.pow(Ee,t),new Je(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?Ce:Math.pow(Ce,t),new Je(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new Oe(Ke(t>=240?t-240:t+120,r,i),Ke(t,r,i),Ke(t<120?t+240:t-120,r,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var Qe=1/.7;function tn(t,e,n,i){return 1===arguments.length?function(t){if(t instanceof en)return new en(t.h,t.s,t.v,t.opacity);t instanceof je||(t=je(t));var e=t.r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),a=Math.max(e,n,i),o=a-r,s=NaN;return o&&(s=e===a?(n-i)/o+6*(n<i):n===a?(i-e)/o+2:(e-n)/o+4,s*=60),new en(s,o/a,a,t.opacity)}(t):new en(t,e,n,null==i?1:i)}function en(t,e,n,i){this.h=+t,this.s=+e,this.v=+n,this.opacity=+i}var nn=en.prototype=tn.prototype=Object.create(Be.prototype);function rn(t,e,n,i,r){return je(255*(t+i),255*(e+i),255*(n+i),r)}function an(t){return function(){return t}}function on(t,e){return function(n){return t+n*e}}function sn(t,e){var n=e-t;return n?on(t,n):an(isNaN(t)?e:t)}function hn(t){return function(e,n){var i=t((e=tn(e)).h,(n=tn(n)).h),r=sn(e.s,n.s),a=sn(e.v,n.v),o=sn(e.opacity,n.opacity);return function(t){return e.h=i(t),e.s=r(t),e.v=a(t),e.opacity=o(t),e+""}}}nn.constructor=en,nn.brighter=function(t){return t=null==t?Qe:Math.pow(Qe,t),new en(this.h,this.s,this.v*t,this.opacity)},nn.darker=function(t){return t=null==t?.7:Math.pow(.7,t),new en(this.h,this.s,this.v*t,this.opacity)},nn.rgb=function(){var t=isNaN(this.h)?0:this.h%360+360*(this.h<0),e=isNaN(this.h)||isNaN(this.s)?0:this.s,n=this.v,i=this.opacity,r=n*e,a=r*(1-Math.abs(t/60%2-1)),o=n-r;return t<60?rn(r,a,0,o,i):t<120?rn(a,r,0,o,i):t<180?rn(0,r,a,o,i):t<240?rn(0,a,r,o,i):t<300?rn(a,0,r,o,i):rn(r,0,a,o,i)},nn.displayable=function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.v&&this.v<=1&&0<=this.opacity&&this.opacity<=1};hn((function(t,e){var n=e-t;return n?on(t,n>180||n<-180?n-360*Math.round(n/360):n):an(isNaN(t)?e:t)})),hn(sn);var ln=function(){function t(t,e){if(this.container=void 0,this.hsv=void 0,this.backUpHue=void 0,this.backUpSaturation=void 0,this.svCanvas=void 0,this.svContext=void 0,this.hCanvas=void 0,this.hContext=void 0,this.CANVAS_SIZE=256,this.controlPointSize=7,this.callbacks=new Map,this.callbackCounter=0,this.inputFields=void 0,this.previewElement=void 0,!t)throw"No element given!";this.container="string"==typeof t?document.querySelector(t):t;var n=Object.assign({initialColor:"#FFF"},e);this.hsv=tn(n.initialColor),Number.isNaN(this.hsv.h)&&(this.hsv.h=180),Number.isNaN(this.hsv.s)&&(this.hsv.s=1),this.backUpHue=this.hsv.h,this.backUpSaturation=this.hsv.s,this.container.classList.add("tfe-color-picker"),this.container.innerHTML='\n      <div class="tfe-color-picker-root">\n        <div class="tfe-color-picker-sl-picker" style="width: '+this.CANVAS_SIZE+"px; height: "+this.CANVAS_SIZE+'px">\n          <canvas class="tfe-color-picker-sl-picker-canvas" width="'+this.CANVAS_SIZE+'" height="'+this.CANVAS_SIZE+'" />\n        </div>\n        <div class="tfe-color-picker-h-picker"  style="height: '+this.CANVAS_SIZE+'px">\n          <canvas class="tfe-color-picker-h-picker-canvas" width="18" height="'+this.CANVAS_SIZE+'" />\n        </div>\n        <form class="tfe-color-picker-input-root">\n          <div class="tfe-color-preview" style="background: '+this.getHEX()+'"></div>\n      \n          <div></div>\n          <div></div>\n      \n          <label for="h">h:</label>\n          <input class="tfe-color-picker-h-input" name="h" type="number" min="0" max="360" step="1" value="'+this.hsv.h.toFixed(0)+'">\n      \n          <label for="s">s:</label>\n          <input class="tfe-color-picker-s-input" name="s" type="number" min="0" max="100" step="1" value="'+(100*this.hsv.s).toFixed(0)+'">\n      \n          <label for="v">v:</label>\n          <input class="tfe-color-picker-v-input" name="v" type="number" min="0" max="100" step="1" value="'+(100*this.hsv.v).toFixed(0)+'">\n      \n          <div></div>\n          <div></div>\n      \n          <label for="r">r:</label>\n          <input class="tfe-color-picker-r-input" name="r" type="number" min="0" max="255" step="1" value="'+this.hsv.rgb().r.toFixed(0)+'">\n      \n          <label for="g">g:</label>\n          <input class="tfe-color-picker-g-input" name="g" type="number" min="0" max="255" step="1" value="'+this.hsv.rgb().g.toFixed(0)+'">\n      \n          <label for="b">b:</label>\n          <input class="tfe-color-picker-b-input" name="b" type="number" min="0" max="255" step="1" value="'+this.hsv.rgb().b.toFixed(0)+'">\n      \n          <div></div>\n          <div></div>\n      \n          <label for="hex">hex:</label>\n          <input class="tfe-color-picker-hex-input" name="hex" type="text" minlength="4" maxlength="7" value="'+this.getHEX()+'">\n        </form>\n      </div>\n    ',this.svCanvas=this.container.querySelector(".tfe-color-picker-sl-picker-canvas"),this.svContext=this.svCanvas.getContext("2d",{alpha:!1}),this.drawSVPicker(),this.addSVEventListener(),this.hCanvas=this.container.querySelector(".tfe-color-picker-h-picker-canvas"),this.hContext=this.hCanvas.getContext("2d",{alpha:!1}),this.drawHPicker(),this.addHEventListener(),this.inputFields={h:this.container.querySelector(".tfe-color-picker-h-input"),s:this.container.querySelector(".tfe-color-picker-s-input"),v:this.container.querySelector(".tfe-color-picker-v-input"),r:this.container.querySelector(".tfe-color-picker-r-input"),g:this.container.querySelector(".tfe-color-picker-g-input"),b:this.container.querySelector(".tfe-color-picker-b-input"),hex:this.container.querySelector(".tfe-color-picker-hex-input")},this.addInputEventListeners(),this.previewElement=this.container.querySelector(".tfe-color-preview")}var e=t.prototype;return e.addListener=function(t,e){void 0===e&&(e=!1);var n=this.callbackCounter++;return this.callbacks.set(n,{callback:t,normalized:e}),t(e?this.getColorNormalized():this.getColor()),n},e.removeListener=function(t){this.callbacks.delete(t)},e.setHEX=function(t){this.hsv=tn(t),this.validateHueAndSaturation(),this.sendUpdate(),this.updateAll()},e.setRGB=function(t,e,n){this.hsv=tn("rgb("+t+","+e+","+n+")"),this.validateHueAndSaturation(),this.sendUpdate(),this.updateAll()},e.setRGBNormalized=function(t,e,n){this.setRGB(255*t,255*e,255*n)},e.setHSL=function(t,e,n){this.hsv=tn("hsl("+t+" "+e+" "+n+")"),this.validateHueAndSaturation(),this.sendUpdate(),this.updateAll()},e.setHSLNormalized=function(t,e,n){this.setHSL(360*t,100*e,100*n)},e.setHSV=function(t,e,n){this.hsv=tn(t,e,n),this.validateHueAndSaturation(),this.sendUpdate(),this.updateAll()},e.setHSVNormalized=function(t,e,n){this.setHSV(360*t,100*e,100*n)},e.getHEX=function(){return this.hsv.formatHex()},e.getRGB=function(){var t=this.hsv.rgb();return{r:t.r,g:t.g,b:t.b}},e.getRGBNormalized=function(){var t=this.hsv.rgb();return{r:t.r/255,g:t.g/255,b:t.b/255}},e.getHSL=function(){var t=de(this.hsv.formatHsl());return{h:t.h,s:100*t.s,l:100*t.l}},e.getHSLNormalized=function(){var t=de(this.hsv.formatHsl());return{h:t.h/360,s:t.s,l:t.l}},e.getHSV=function(){return{h:this.hsv.h,s:100*this.hsv.s,v:100*this.hsv.v}},e.getHSVNormalized=function(){return{h:this.hsv.h/360,s:this.hsv.s,v:this.hsv.v}},e.getColor=function(){return{rgb:this.getRGB(),hsl:this.getHSL(),hsv:this.getHSV(),hex:this.getHEX()}},e.getColorNormalized=function(){return{rgb:this.getRGBNormalized(),hsl:this.getHSLNormalized(),hsv:this.getHSVNormalized(),hex:this.getHEX()}},e.sendUpdate=function(){var t=this;this.previewElement.style.backgroundColor=this.getHEX(),this.callbacks.forEach((function(e){e.callback(e.normalized?t.getColorNormalized():t.getColor())}))},e.updateAll=function(){this.drawAll(),this.updateInputFields()},e.drawAll=function(){this.drawHPicker(),this.drawSVPicker()},e.drawSVPicker=function(){for(var t=0;t<this.CANVAS_SIZE;t++){var e=this.svContext.createLinearGradient(0,0,this.CANVAS_SIZE,0);e.addColorStop(0,tn(this.hsv.h,0,1-t/this.CANVAS_SIZE).formatHex()),e.addColorStop(1,tn(this.hsv.h,1,1-t/this.CANVAS_SIZE).formatHex()),this.svContext.fillStyle=e,this.svContext.fillRect(0,t,this.CANVAS_SIZE,1)}for(var n=this.hsv.s*this.CANVAS_SIZE,i=(1-this.hsv.v)*this.CANVAS_SIZE,r=0;r<10;r++)this.svContext.beginPath(),this.svContext.strokeStyle=r%2==0?"white":"black",this.svContext.arc(n,i,this.controlPointSize,r/10*(2*Math.PI),(r+1)/10*(2*Math.PI)),this.svContext.stroke()},e.drawHPicker=function(){var t=this.hContext.createLinearGradient(0,0,0,this.hCanvas.height);t.addColorStop(0,"#ff0000"),t.addColorStop(1/6,"#ff00ff"),t.addColorStop(2/6,"#0000ff"),t.addColorStop(.5,"#00ffff"),t.addColorStop(4/6,"#00ff00"),t.addColorStop(5/6,"#ffff00"),t.addColorStop(1,"#ff0000"),this.hContext.fillStyle=t,this.hContext.fillRect(0,0,this.hCanvas.width,this.hCanvas.height);for(var e=this.hCanvas.width/2,n=(1-this.hsv.h/360)*this.hCanvas.height,i=0;i<10;i++)this.hContext.beginPath(),this.hContext.strokeStyle=i%2==0?"white":"black",this.hContext.arc(e,n,this.controlPointSize,i/10*(2*Math.PI),(i+1)/10*(2*Math.PI)),this.hContext.stroke()},e.addSVEventListener=function(){var t=this,e=!1,n=null,i=function(e,n){t.hsv.s=un(e/t.CANVAS_SIZE,0,1),t.backUpSaturation=t.hsv.s,t.hsv.v=un(1-n/t.CANVAS_SIZE,0,1),t.sendUpdate(),t.drawSVPicker(),t.updateHSVInputFields(),t.updateRGBInputFields(),t.updateHEXInputField()};this.svCanvas.addEventListener("mousedown",(function(r){0===r.button&&(n=new AbortController,document.addEventListener("mousemove",(function(e){e.preventDefault(),i(e.clientX-t.svCanvas.getBoundingClientRect().x,e.clientY-t.svCanvas.getBoundingClientRect().y)}),{signal:n.signal}),e=!0,i(r.offsetX,r.offsetY))})),document.addEventListener("mouseup",(function(){e&&n&&(n.abort(),n=null,e=!1)}))},e.addHEventListener=function(){var t=this,e=!1,n=null,i=function(e){t.hsv.h=un(Math.round(360*(1-e/t.CANVAS_SIZE)),0,360),t.backUpHue=t.hsv.h,t.sendUpdate(),t.drawAll(),t.inputFields.h.valueAsNumber=Math.round(t.hsv.h),t.updateRGBInputFields(),t.updateHEXInputField()};this.hCanvas.addEventListener("mousedown",(function(r){n=new AbortController,document.addEventListener("mousemove",(function(e){e.preventDefault(),i(e.clientY-t.svCanvas.getBoundingClientRect().y)}),{signal:n.signal}),e=!0,i(r.offsetY)})),document.addEventListener("mouseup",(function(){e&&n&&(n.abort(),n=null,e=!1)}))},e.validateInput=function(t,e,n){return t.valueAsNumber<e?t.valueAsNumber=e:t.valueAsNumber>n&&(t.valueAsNumber=n),Number.isFinite(t.valueAsNumber)?t.valueAsNumber:null},e.validateFinalInput=function(t,e,n){return null===this.validateInput(t,e,n)?(t.valueAsNumber=e,e):null},e.addInputEventListeners=function(){this.setupHSVListeners(),this.setupRGBListeners(),this.setupHEXListeners()},e.setupHSVListeners=function(){var t=this,e=function(){t.sendUpdate(),t.drawAll(),t.updateRGBInputFields(),t.updateHEXInputField()},n=function(n){null!==n&&(t.hsv.h=n,t.backUpHue=n,e())};this.inputFields.h.addEventListener("input",(function(e){var i=t.validateInput(e.currentTarget,0,360);n(i)})),this.inputFields.h.addEventListener("wheel",(function(e){e.preventDefault();var i=Math.round(t.hsv.h);e.deltaY>0?i=un(i-1,0,360):e.deltaY<0&&(i=un(i+1,0,360)),n(i),t.inputFields.h.valueAsNumber=i}));var i=function(e){var i=t.validateFinalInput(e.currentTarget,0,360);n(i)};this.inputFields.h.addEventListener("focusout",i),this.inputFields.h.addEventListener("keypress",(function(t){"Enter"===t.key&&i(t)}));var r=function(n){null!==n&&(t.hsv.s=n/100,t.backUpSaturation=t.hsv.s,e())};this.inputFields.s.addEventListener("input",(function(e){var n=t.validateInput(e.currentTarget,0,100);r(n)})),this.inputFields.s.addEventListener("wheel",(function(e){e.preventDefault();var n=Math.round(100*t.hsv.s);e.deltaY>0?n=un(n-1,0,100):e.deltaY<0&&(n=un(n+1,0,100)),r(n),t.inputFields.s.valueAsNumber=n}));var a=function(e){var n=t.validateFinalInput(e.currentTarget,0,100);r(n)};this.inputFields.s.addEventListener("focusout",a),this.inputFields.s.addEventListener("keypress",(function(t){"Enter"===t.key&&a(t)}));var o=function(n){null!==n&&(t.hsv.v=n/100,e())};this.inputFields.v.addEventListener("input",(function(e){var n=t.validateInput(e.currentTarget,0,100);o(n)})),this.inputFields.v.addEventListener("wheel",(function(e){e.preventDefault();var n=Math.round(100*t.hsv.v);e.deltaY>0?n=un(n-1,0,100):e.deltaY<0&&(n=un(n+1,0,100)),o(n),t.inputFields.v.valueAsNumber=n}));var s=function(e){var n=t.validateFinalInput(e.currentTarget,0,100);o(n)};this.inputFields.v.addEventListener("focusout",s),this.inputFields.v.addEventListener("keypress",(function(t){"Enter"===t.key&&s(t)}))},e.setupRGBListeners=function(){var t=this,e=function(e,n,i){t.hsv=tn("rgb("+Math.round(e)+","+Math.round(n)+","+Math.round(i)+")"),t.validateHueAndSaturation(),t.sendUpdate(),t.drawAll(),t.updateHSVInputFields(),t.updateHEXInputField()},n=function(n){if(null!==n){var i=t.hsv.rgb();e(n,i.g,i.b)}};this.inputFields.r.addEventListener("input",(function(e){var i=t.validateInput(e.currentTarget,0,255);n(i)})),this.inputFields.r.addEventListener("wheel",(function(e){e.preventDefault();var i=t.hsv.rgb().r;e.deltaY>0?i=un(i-1,0,255):e.deltaY<0&&(i=un(i+1,0,255)),n(i),t.inputFields.r.valueAsNumber=Math.round(i)}));var i=function(e){var i=t.validateFinalInput(e.currentTarget,0,255);n(i)};this.inputFields.r.addEventListener("focusout",i),this.inputFields.r.addEventListener("keypress",(function(t){"Enter"===t.key&&i(t)}));var r=function(n){if(null!==n){var i=t.hsv.rgb();e(i.r,n,i.b)}};this.inputFields.g.addEventListener("input",(function(e){var n=t.validateInput(e.currentTarget,0,255);r(n)})),this.inputFields.g.addEventListener("wheel",(function(e){e.preventDefault();var n=t.hsv.rgb().g;e.deltaY>0?n=un(n-1,0,255):e.deltaY<0&&(n=un(n+1,0,255)),r(n),t.inputFields.g.valueAsNumber=Math.round(n)}));var a=function(e){var n=t.validateFinalInput(e.currentTarget,0,255);r(n)};this.inputFields.g.addEventListener("focusout",a),this.inputFields.g.addEventListener("keypress",(function(t){"Enter"===t.key&&a(t)}));var o=function(n){if(null!==n){var i=t.hsv.rgb();e(i.r,i.g,n)}};this.inputFields.b.addEventListener("input",(function(e){var n=t.validateInput(e.currentTarget,0,255);o(n)})),this.inputFields.b.addEventListener("wheel",(function(e){e.preventDefault();var n=t.hsv.rgb().b;e.deltaY>0?n=un(n-1,0,255):e.deltaY<0&&(n=un(n+1,0,255)),o(n),t.inputFields.b.valueAsNumber=Math.round(n)}));var s=function(e){var n=t.validateFinalInput(e.currentTarget,0,255);o(n)};this.inputFields.b.addEventListener("focusout",s),this.inputFields.b.addEventListener("keypress",(function(t){"Enter"===t.key&&s(t)}))},e.setupHEXListeners=function(){var t=this;this.inputFields.hex.addEventListener("input",(function(e){var n=e.currentTarget,i=n.value;i.match(/#([0-7a-fA-F]{3}$|[0-7a-fA-F]{6}$)/)?(t.hsv=tn(i),t.validateHueAndSaturation(),t.sendUpdate(),t.drawAll(),t.updateRGBInputFields(),t.updateHSVInputFields(),n.classList.remove("tfe-color-picker-input-hex-invalid")):n.classList.add("tfe-color-picker-input-hex-invalid")})),this.inputFields.hex.addEventListener("focusout",(function(e){var n=e.currentTarget;n.value.match(/#([0-7a-fA-F]{3}$|[0-7a-fA-F]{6}$)/)||(n.value=t.getHEX(),n.classList.remove("tfe-color-picker-input-hex-invalid"))}))},e.updateInputFields=function(){this.updateHSVInputFields(),this.updateRGBInputFields(),this.updateHEXInputField()},e.updateHSVInputFields=function(){this.inputFields.h.valueAsNumber=un(Math.round(this.hsv.h),0,360),this.inputFields.s.valueAsNumber=un(Math.round(100*this.hsv.s),0,100),this.inputFields.v.valueAsNumber=un(Math.round(100*this.hsv.v),0,100)},e.updateRGBInputFields=function(){var t=this.hsv.rgb();this.inputFields.r.valueAsNumber=un(Math.round(t.r),0,255),this.inputFields.g.valueAsNumber=un(Math.round(t.g),0,255),this.inputFields.b.valueAsNumber=un(Math.round(t.b),0,255)},e.updateHEXInputField=function(){this.inputFields.hex.value=this.getHEX()},e.validateHueAndSaturation=function(){Number.isNaN(this.hsv.h)?this.hsv.h=this.backUpHue:this.backUpHue=this.hsv.h,Number.isNaN(this.hsv.s)?this.hsv.s=this.backUpSaturation:this.backUpSaturation=this.hsv.s},t}();function un(t,e,n){return Math.max(e,Math.min(n,t))}null===document.head.querySelector("#tfe-color-picker-style")&&document.head.insertAdjacentHTML("beforeend",'\n    <style id="tfe-color-picker-style">\n      .tfe-color-picker-root {\n        display: flex;\n        justify-content: center;\n      }\n    \n      .tfe-color-picker-sl-picker {\n        border: 1px solid grey;\n      }\n    \n      .tfe-color-picker-h-picker {\n        width: 18px;\n        margin-left: 12px;\n        border: 1px solid grey;\n      }\n    \n      .tfe-color-picker-input-root {\n        display: grid;\n        grid-template-columns: 36px 60px;\n        grid-template-rows: repeat(3, auto) 20px repeat(3, auto) 20px auto;\n        grid-column-gap: 6px;\n        grid-row-gap: 6px;\n        align-items: center;\n        align-content: space-evenly;\n        margin-left: 12px;\n        margin-bottom: 0;\n      }\n    \n      .tfe-color-preview {\n        grid-column: 1 / span 2;\n        height: 50px;\n        border: 1px solid grey;\n        border-radius: 25px;\n      }\n    \n      .tfe-color-picker-input-root > label {\n        text-align: right;\n      }\n    \n      .tfe-color-picker-input-root > input {\n        text-align: right;\n        font-family: monospace;\n      }\n    \n      .tfe-color-picker-input-hex-invalid:focus-visible {\n        outline-color: red;\n      }\n    </style>');var cn,dn,pn=function(){function t(t,e){if(this.container=void 0,this.canvas=void 0,this.ctx=void 0,this.colorRange=void 0,this.colorMap=void 0,this.controlPointSize=7,this.colorPickerContainer=void 0,this.colorPicker=void 0,this.callbacks=new Map,this.callbackCounter=0,!t)throw"No element given!";this.container="string"==typeof t?document.querySelector(t):t;var n=Object.assign({initialColorMap:[{stop:0,rgb:"blue"},{stop:.5,rgb:"white"},{stop:1,rgb:"red"}]},e);this.colorMap=n.initialColorMap,this.container.classList.add("tfe-color-map-editor"),this.canvas=document.createElement("canvas"),this.canvas.width=this.container.clientWidth,this.canvas.height=this.container.clientHeight,this.container.appendChild(this.canvas),this.ctx=this.canvas.getContext("2d",{alpha:!1}),this.colorPickerContainer=document.createElement("div"),this.colorPickerContainer.classList.add("tfe-color-map-editor-color-picker-container"),this.colorPickerContainer.style.width="fit-content",this.colorPickerContainer.style.padding="12px",this.colorPickerContainer.style.backgroundColor="white",this.colorPickerContainer.style.border="1px solid black",this.colorPickerContainer.style.visibility="hidden",this.colorPickerContainer.style.position="relative",this.container.appendChild(this.colorPickerContainer),this.colorPicker=new ln(this.colorPickerContainer),this.updateColorRange(),this.draw(),this.addEventListeners()}var e=t.prototype;return e.setColorMap=function(t){this.colorMap=t,this.updateColorRange(),this.draw(),this.sendUpdates()},e.getColorMap=function(){return this.colorMap},e.addListener=function(t){var e=this.callbackCounter++;return this.callbacks.set(e,t),t(this.colorMap),e},e.removeListener=function(t){this.callbacks.delete(t)},e.sendUpdates=function(){var t=this;this.callbacks.forEach((function(e){return e(t.colorMap)}))},e.draw=function(){for(var t=0;t<this.canvas.width;++t)this.ctx.fillStyle=this.colorRange(t/(this.canvas.width-1)),this.ctx.fillRect(t,0,1,this.canvas.height);this.ctx.fillStyle="transparent";for(var e=0;e<this.colorMap.length;e++)for(var n=this.colorMap[e].stop*this.canvas.width,i=.5*this.canvas.height,r=0;r<10;r++)this.ctx.beginPath(),this.ctx.strokeStyle=r%2==0?"white":"black",this.ctx.arc(n,i,this.controlPointSize,r/10*(2*Math.PI),(r+1)/10*(2*Math.PI)),this.ctx.stroke()},e.updateColorRange=function(){this.colorRange=$t().domain(this.colorMap.map((function(t){return t.stop}))).range(this.colorMap.map((function(t){return t.rgb}))).interpolate(ke)},e.addEventListeners=function(){var t=this,e=!1,n=!1,i=-1,r=null,a=function(a){i=-1;for(var o=0;o<t.colorMap.length;o++)if(Math.abs(t.colorMap[o].stop*t.canvas.width-a.offsetX)<t.controlPointSize){i=o,n=!0;break}n&&(r=new AbortController,document.addEventListener("mousemove",(function(n){n.preventDefault();var r=n.clientX-t.canvas.getBoundingClientRect().x,a=Math.max(0,Math.min(1,r/t.canvas.width));0!==i&&i!==t.colorMap.length-1&&(t.colorMap[i].stop=a),t.colorMap.sort((function(t,e){return t.stop-e.stop})),t.updateColorRange(),t.draw(),t.sendUpdates(),e=!0}),{signal:r.signal}))};this.canvas.addEventListener("mousedown",(function(i){if(e=!1,0===i.button){if(a(i),!n){var r=Math.max(0,Math.min(1,i.offsetX/t.canvas.width)),o=t.colorRange(r);t.colorMap.push({stop:r,rgb:o}),t.colorMap.sort((function(t,e){return t.stop-e.stop})),t.updateColorRange(),t.draw(),t.sendUpdates(),a(i)}}else if(1===i.button){i.preventDefault();for(var s=1;s<t.colorMap.length-1;s++){var h=t.colorMap[s].stop*t.canvas.width-i.offsetX,l=.5*t.canvas.height-i.offsetY;if(Math.sqrt(h*h+l*l)<t.controlPointSize)return t.colorMap.splice(s,1),t.updateColorRange(),t.draw(),void t.sendUpdates()}}})),document.addEventListener("mouseup",(function(){n&&r&&(r.abort(),r=null,n=!1,i=-1)}));var o=-1;this.canvas.addEventListener("click",(function(n){if(!e){n.stopPropagation();for(var i=null,r=0;r<t.colorMap.length&&(i=t.colorMap[r],!(Math.abs(i.stop*t.canvas.width-n.offsetX)<t.controlPointSize));r++);if(null!==i){var a=t.canvas.height/2+t.canvas.getBoundingClientRect().y,s=window.innerHeight,h=t.colorPickerContainer.clientHeight;t.colorPickerContainer.style.bottom=a+h<s?t.canvas.height/2+"px":a-h>0?t.canvas.height/2+h+"px":t.canvas.height/2+h/2+"px";var l=i.stop*t.canvas.width+t.canvas.getBoundingClientRect().x,u=window.innerWidth,c=t.colorPickerContainer.clientWidth;t.colorPickerContainer.style.left=l+c<u?i.stop*t.canvas.width+"px":l-c>0?i.stop*t.canvas.width-c+"px":i.stop*t.canvas.width-c/2+"px",t.colorPickerContainer.style.visibility="visible",t.colorPicker.removeListener(o),t.colorPicker.setHEX(i.rgb),o=t.colorPicker.addListener((function(e){i.rgb=e.hex,t.updateColorRange(),t.draw(),t.sendUpdates()}))}}})),document.addEventListener("click",(function(){t.colorPickerContainer.style.visibility="hidden"})),this.colorPickerContainer.addEventListener("click",(function(t){return t.stopPropagation()})),new ResizeObserver((function(){t.canvas.width=t.container.clientWidth,t.canvas.height=t.container.clientHeight,t.draw()})).observe(this.container)},t}(),fn=function(){function t(t,e){if(this.container=void 0,this.canvas=void 0,this.ctx=void 0,this.transferFunction=void 0,this.colorMap=void 0,this.alphaRange=void 0,this.colorRange=void 0,this.controlPointSize=7,this.callbacks=new Map,this.callbackCounter=0,!t)throw"No element given!";this.container="string"==typeof t?document.querySelector(t):t;var n=Object.assign({initialTransferFunction:[{stop:0,alpha:1},{stop:.5,alpha:.5},{stop:1,alpha:0}],initialColorMap:[{stop:0,rgb:"black"},{stop:1,rgb:"black"}]},e);this.transferFunction=n.initialTransferFunction,this.colorMap=n.initialColorMap,this.container.classList.add("tfe-transparency-editor"),this.canvas=document.createElement("canvas"),this.canvas.width=this.container.clientWidth,this.canvas.height=this.container.clientHeight,this.canvas.style.imageRendering="pixelated",this.container.appendChild(this.canvas),this.ctx=this.canvas.getContext("2d"),this.updateColorRange(),this.updateAlphaRange(),this.draw(),this.addEventListeners()}var e=t.prototype;return e.addListener=function(t){var e=this.callbackCounter++;return this.callbacks.set(e,t),t(this.getTransferFunction()),e},e.removeListener=function(t){this.callbacks.delete(t)},e.getTransferFunction=function(){return{alphaStops:this.transferFunction,colorMap:this.colorMap}},e.getRGB=function(t){return this.colorRange(t)},e.getAlpha=function(t){return this.alphaRange(t)},e.getRGBA=function(t){var e=ie(this.getRGB(t)),n=this.getAlpha(t);return e.opacity=1-n,e.formatHex8()},e.addControlPoint=function(t,e){this.transferFunction.push({stop:t,alpha:e}),this.sortControlPoints(),this.updateAlphaRange(),this.sendUpdate(),this.draw()},e.removeControlPointAt=function(t,e){for(var n=-1,i=1;i<this.transferFunction.length-1;i++){var r=this.transferFunction[i],a=r.stop*this.canvas.width-t,o=r.alpha*this.canvas.height-e;if(Math.sqrt(a*a+o*o)<this.controlPointSize){n=i;break}}-1!==n&&(this.transferFunction.splice(n,1),this.updateAlphaRange(),this.sendUpdate(),this.draw())},e.setAlphaStops=function(t){this.transferFunction=t,this.updateAlphaRange(),this.sendUpdate(),this.draw()},e.getAlphaStops=function(){return this.transferFunction},e.setColorMap=function(t){this.colorMap=t,this.updateColorRange(),this.sendUpdate(),this.draw()},e.sendUpdate=function(){var t=this;this.callbacks.forEach((function(e){return e({alphaStops:t.transferFunction,colorMap:t.colorMap})}))},e.updateColorRange=function(){this.colorRange=$t().domain(this.colorMap.map((function(t){return t.stop}))).range(this.colorMap.map((function(t){return t.rgb}))).interpolate(ke)},e.updateAlphaRange=function(){this.alphaRange=$t().domain(this.transferFunction.map((function(t){return t.stop}))).range(this.transferFunction.map((function(t){return t.alpha}))).interpolate(xe)},e.draw=function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);for(var t=0;t<this.canvas.width;++t){var e=this.getAlpha(t/(this.canvas.width-1));this.ctx.fillStyle=this.getRGBA(t/(this.canvas.width-1)),this.ctx.fillRect(t,e*this.canvas.height,1,(1-e)*this.canvas.height)}this.ctx.strokeStyle="black",this.ctx.beginPath();for(var n=0;n<this.transferFunction.length;n++){var i=this.transferFunction[n].stop*this.canvas.width,r=this.transferFunction[n].alpha*this.canvas.height;0===n?this.ctx.moveTo(i,r):this.ctx.lineTo(i,r)}this.ctx.stroke(),this.ctx.fillStyle="white";for(var a=0;a<this.transferFunction.length;a++){var o=this.transferFunction[a].stop*this.canvas.width,s=this.transferFunction[a].alpha*this.canvas.height;this.ctx.strokeStyle="black",this.ctx.beginPath(),this.ctx.arc(o,s,this.controlPointSize,0,2*Math.PI),this.ctx.fill(),this.ctx.stroke()}},e.sortControlPoints=function(){this.transferFunction.sort((function(t,e){return t.stop-e.stop}))},e.pixelToNormalized=function(t,e){return{stop:Math.max(0,Math.min(1,t/this.canvas.width)),alpha:Math.max(0,Math.min(1,e/this.canvas.height))}},e.addEventListeners=function(){var t=this,e=!1,n=-1,i=null,r=function(r){n=-1;for(var a=0;a<t.transferFunction.length;a++){var o=t.transferFunction[a],s=o.stop*t.canvas.width-r.offsetX,h=o.alpha*t.canvas.height-r.offsetY;if(Math.sqrt(s*s+h*h)<t.controlPointSize){n=a,e=!0;break}}e&&(i=new AbortController,document.addEventListener("mousemove",(function(e){e.preventDefault();var i=e.clientX-t.canvas.getBoundingClientRect().x,r=e.clientY-t.canvas.getBoundingClientRect().y,a=t.pixelToNormalized(i,r),o=a.alpha;0===n||n===t.transferFunction.length-1||(t.transferFunction[n].stop=a.stop),t.transferFunction[n].alpha=o,t.sortControlPoints(),t.updateAlphaRange(),t.sendUpdate(),t.draw()}),{signal:i.signal}))};this.canvas.addEventListener("mousedown",(function(n){if(0===n.button&&r(n),!e)if(0===n.button){var i=t.pixelToNormalized(n.offsetX,n.offsetY);t.addControlPoint(i.stop,i.alpha),r(n)}else 1===n.button&&(n.preventDefault(),t.removeControlPointAt(n.offsetX,n.offsetY))})),document.addEventListener("mouseup",(function(){e&&i&&(i.abort(),i=null,e=!1,n=-1)})),new ResizeObserver((function(){t.canvas.width=t.container.clientWidth,t.canvas.height=t.container.clientHeight,t.draw()})).observe(this.container)},t}(),gn=function(){function t(t,e){var n=this;if(this.container=void 0,this.transparencyEditor=void 0,this.colorMapEditor=void 0,this.callbacks=new Map,this.callbackCounter=0,!t)throw"No element given!";this.container="string"==typeof t?document.querySelector(t):t;var i=Object.assign({},e);this.container.classList.add("tfe-transfer-function-editor");var r=document.createElement("div");r.style.width="100%",r.style.minHeight="50px",this.container.append(r),this.transparencyEditor=new fn(r,i);var a=document.createElement("div");a.style.width="100%",a.style.minHeight="10px",this.container.append(a),this.colorMapEditor=new pn(a,i),this.colorMapEditor.addListener((function(t){return n.transparencyEditor.setColorMap(t)})),this.transparencyEditor.setColorMap(this.colorMapEditor.getColorMap()),this.transparencyEditor.addListener((function(t){n.callbacks.forEach((function(e){return e(t)}))}))}var e=t.prototype;return e.addListener=function(t){var e=this.callbackCounter++;return this.callbacks.set(e,t),t(this.transparencyEditor.getTransferFunction()),e},e.removeListener=function(t){this.callbacks.delete(t)},e.setAlphaStops=function(t){this.transparencyEditor.setAlphaStops(t)},e.setColorMap=function(t){this.colorMapEditor.setColorMap(t)},e.getAlphaStops=function(){return this.transparencyEditor.getAlphaStops()},e.getColorMap=function(){return this.colorMapEditor.getColorMap()},t}();(dn=cn||(cn={})).RGB="RGB",dn.HSV="HSV",dn.LAB="Lab",dn.DIVERGING="Diverging",dn.LAB_CIEDE2000="Lab/CIEDE2000",dn.STEP="Step";new gn("#tf-editor").addListener((t=>{document.querySelector("#tf-output").innerText=JSON.stringify(t,null,2)}));new fn("#tp").addListener((t=>{document.querySelector("#tp-output").innerText=JSON.stringify(t,null,2)}));new pn("#cm",{initialColorMap:[{stop:0,rgb:"#0f0"},{stop:.5,rgb:"#f00"},{stop:1,rgb:"#000"}]}).addListener((t=>{document.querySelector("#cm-output").innerText=JSON.stringify(t,null,2)}));new ln("#cp",{initialColor:"cyan"}).addListener((t=>{document.querySelector("#cp-output").innerText=JSON.stringify(t,null,2)}));
//# sourceMappingURL=index.85b06549.js.map
