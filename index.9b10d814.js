var t=Math.sqrt(50),n=Math.sqrt(10),e=Math.sqrt(2);function i(t,n,e){var i,a,o,s,h=-1;if(e=+e,(t=+t)===(n=+n)&&e>0)return[t];if((i=n<t)&&(a=t,t=n,n=a),0===(s=r(t,n,e))||!isFinite(s))return[];if(s>0){let e=Math.round(t/s),i=Math.round(n/s);for(e*s<t&&++e,i*s>n&&--i,o=new Array(a=i-e+1);++h<a;)o[h]=(e+h)*s}else{s=-s;let e=Math.round(t*s),i=Math.round(n*s);for(e/s<t&&++e,i/s>n&&--i,o=new Array(a=i-e+1);++h<a;)o[h]=(e+h)/s}return i&&o.reverse(),o}function r(i,r,a){var o=(r-i)/Math.max(0,a),s=Math.floor(Math.log(o)/Math.LN10),h=o/Math.pow(10,s);return s>=0?(h>=t?10:h>=n?5:h>=e?2:1)*Math.pow(10,s):-Math.pow(10,-s)/(h>=t?10:h>=n?5:h>=e?2:1)}function a(i,r,a){var o=Math.abs(r-i)/Math.max(0,a),s=Math.pow(10,Math.floor(Math.log(o)/Math.LN10)),h=o/s;return h>=t?s*=10:h>=n?s*=5:h>=e&&(s*=2),r<i?-s:s}function o(t,n){return t<n?-1:t>n?1:t>=n?0:NaN}function s(t){let n=t,e=t;function i(t,n,i,r){for(null==i&&(i=0),null==r&&(r=t.length);i<r;){const a=i+r>>>1;e(t[a],n)<0?i=a+1:r=a}return i}return 1===t.length&&(n=(n,e)=>t(n)-e,e=function(t){return(n,e)=>o(t(n),e)}(t)),{left:i,center:function(t,e,r,a){null==r&&(r=0),null==a&&(a=t.length);const o=i(t,e,r,a-1);return o>r&&n(t[o-1],e)>-n(t[o],e)?o-1:o},right:function(t,n,i,r){for(null==i&&(i=0),null==r&&(r=t.length);i<r;){const a=i+r>>>1;e(t[a],n)>0?r=a:i=a+1}return i}}}const h=s(o),l=h.right;h.left,s((function(t){return null===t?NaN:+t})).center;var u=l;function c(t,n,e){t.prototype=n.prototype=e,e.constructor=t}function d(t,n){var e=Object.create(t.prototype);for(var i in n)e[i]=n[i];return e}function p(){}var f=.7,g=1.4285714285714286,v="\\s*([+-]?\\d+)\\s*",m="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",b="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",y=/^#([0-9a-f]{3,8})$/,w=new RegExp("^rgb\\("+[v,v,v]+"\\)$"),k=new RegExp("^rgb\\("+[b,b,b]+"\\)$"),x=new RegExp("^rgba\\("+[v,v,v,m]+"\\)$"),M=new RegExp("^rgba\\("+[b,b,b,m]+"\\)$"),N=new RegExp("^hsl\\("+[m,b,b]+"\\)$"),S=new RegExp("^hsla\\("+[m,b,b,m]+"\\)$"),E={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function C(){return this.rgb().formatHex()}function A(){return this.rgb().formatRgb()}function P(t){var n,e;return t=(t+"").trim().toLowerCase(),(n=y.exec(t))?(e=n[1].length,n=parseInt(n[1],16),6===e?I(n):3===e?new R(n>>8&15|n>>4&240,n>>4&15|240&n,(15&n)<<4|15&n,1):8===e?H(n>>24&255,n>>16&255,n>>8&255,(255&n)/255):4===e?H(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|240&n,((15&n)<<4|15&n)/255):null):(n=w.exec(t))?new R(n[1],n[2],n[3],1):(n=k.exec(t))?new R(255*n[1]/100,255*n[2]/100,255*n[3]/100,1):(n=x.exec(t))?H(n[1],n[2],n[3],n[4]):(n=M.exec(t))?H(255*n[1]/100,255*n[2]/100,255*n[3]/100,n[4]):(n=N.exec(t))?V(n[1],n[2]/100,n[3]/100,1):(n=S.exec(t))?V(n[1],n[2]/100,n[3]/100,n[4]):E.hasOwnProperty(t)?I(E[t]):"transparent"===t?new R(NaN,NaN,NaN,0):null}function I(t){return new R(t>>16&255,t>>8&255,255&t,1)}function H(t,n,e,i){return i<=0&&(t=n=e=NaN),new R(t,n,e,i)}function F(t,n,e,i){return 1===arguments.length?((r=t)instanceof p||(r=P(r)),r?new R((r=r.rgb()).r,r.g,r.b,r.opacity):new R):new R(t,n,e,null==i?1:i);var r}function R(t,n,e,i){this.r=+t,this.g=+n,this.b=+e,this.opacity=+i}function L(){return"#"+q(this.r)+q(this.g)+q(this.b)}function $(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function q(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function V(t,n,e,i){return i<=0?t=n=e=NaN:e<=0||e>=1?t=n=NaN:n<=0&&(t=NaN),new X(t,n,e,i)}function U(t){if(t instanceof X)return new X(t.h,t.s,t.l,t.opacity);if(t instanceof p||(t=P(t)),!t)return new X;if(t instanceof X)return t;var n=(t=t.rgb()).r/255,e=t.g/255,i=t.b/255,r=Math.min(n,e,i),a=Math.max(n,e,i),o=NaN,s=a-r,h=(a+r)/2;return s?(o=n===a?(e-i)/s+6*(e<i):e===a?(i-n)/s+2:(n-e)/s+4,s/=h<.5?a+r:2-a-r,o*=60):s=h>0&&h<1?0:o,new X(o,s,h,t.opacity)}function X(t,n,e,i){this.h=+t,this.s=+n,this.l=+e,this.opacity=+i}function T(t,n,e){return 255*(t<60?n+(e-n)*t/60:t<180?e:t<240?n+(e-n)*(240-t)/60:n)}function z(t,n,e,i,r){var a=t*t,o=a*t;return((1-3*t+3*a-o)*n+(4-6*a+3*o)*e+(1+3*t+3*a-3*o)*i+o*r)/6}c(p,P,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:C,formatHex:C,formatHsl:function(){return U(this).formatHsl()},formatRgb:A,toString:A}),c(R,F,d(p,{brighter:function(t){return t=null==t?g:Math.pow(g,t),new R(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?f:Math.pow(f,t),new R(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:L,formatHex:L,formatRgb:$,toString:$})),c(X,(function(t,n,e,i){return 1===arguments.length?U(t):new X(t,n,e,null==i?1:i)}),d(p,{brighter:function(t){return t=null==t?g:Math.pow(g,t),new X(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?f:Math.pow(f,t),new X(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),n=isNaN(t)||isNaN(this.s)?0:this.s,e=this.l,i=e+(e<.5?e:1-e)*n,r=2*e-i;return new R(T(t>=240?t-240:t+120,r,i),T(t,r,i),T(t<120?t+240:t-120,r,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var G=t=>()=>t;function B(t,n){return function(e){return t+e*n}}function D(t){return 1==(t=+t)?j:function(n,e){return e-n?function(t,n,e){return t=Math.pow(t,e),n=Math.pow(n,e)-t,e=1/e,function(i){return Math.pow(t+i*n,e)}}(n,e,t):G(isNaN(n)?e:n)}}function j(t,n){var e=n-t;return e?B(t,e):G(isNaN(t)?n:t)}var O=function t(n){var e=D(n);function i(t,n){var i=e((t=F(t)).r,(n=F(n)).r),r=e(t.g,n.g),a=e(t.b,n.b),o=j(t.opacity,n.opacity);return function(n){return t.r=i(n),t.g=r(n),t.b=a(n),t.opacity=o(n),t+""}}return i.gamma=t,i}(1);function Z(t){return function(n){var e,i,r=n.length,a=new Array(r),o=new Array(r),s=new Array(r);for(e=0;e<r;++e)i=F(n[e]),a[e]=i.r||0,o[e]=i.g||0,s[e]=i.b||0;return a=t(a),o=t(o),s=t(s),i.opacity=1,function(t){return i.r=a(t),i.g=o(t),i.b=s(t),i+""}}}Z((function(t){var n=t.length-1;return function(e){var i=e<=0?e=0:e>=1?(e=1,n-1):Math.floor(e*n),r=t[i],a=t[i+1],o=i>0?t[i-1]:2*r-a,s=i<n-1?t[i+2]:2*a-r;return z((e-i/n)*n,o,r,a,s)}})),Z((function(t){var n=t.length;return function(e){var i=Math.floor(((e%=1)<0?++e:e)*n),r=t[(i+n-1)%n],a=t[i%n],o=t[(i+1)%n],s=t[(i+2)%n];return z((e-i/n)*n,r,a,o,s)}}));function _(t,n){n||(n=[]);var e,i=t?Math.min(n.length,t.length):0,r=n.slice();return function(a){for(e=0;e<i;++e)r[e]=t[e]*(1-a)+n[e]*a;return r}}function Y(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function J(t,n){var e,i=n?n.length:0,r=t?Math.min(i,t.length):0,a=new Array(r),o=new Array(i);for(e=0;e<r;++e)a[e]=it(t[e],n[e]);for(;e<i;++e)o[e]=n[e];return function(t){for(e=0;e<r;++e)o[e]=a[e](t);return o}}function W(t,n){var e=new Date;return t=+t,n=+n,function(i){return e.setTime(t*(1-i)+n*i),e}}function K(t,n){return t=+t,n=+n,function(e){return t*(1-e)+n*e}}function Q(t,n){var e,i={},r={};for(e in null!==t&&"object"==typeof t||(t={}),null!==n&&"object"==typeof n||(n={}),n)e in t?i[e]=it(t[e],n[e]):r[e]=n[e];return function(t){for(e in i)r[e]=i[e](t);return r}}var tt=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,nt=new RegExp(tt.source,"g");function et(t,n){var e,i,r,a=tt.lastIndex=nt.lastIndex=0,o=-1,s=[],h=[];for(t+="",n+="";(e=tt.exec(t))&&(i=nt.exec(n));)(r=i.index)>a&&(r=n.slice(a,r),s[o]?s[o]+=r:s[++o]=r),(e=e[0])===(i=i[0])?s[o]?s[o]+=i:s[++o]=i:(s[++o]=null,h.push({i:o,x:K(e,i)})),a=nt.lastIndex;return a<n.length&&(r=n.slice(a),s[o]?s[o]+=r:s[++o]=r),s.length<2?h[0]?function(t){return function(n){return t(n)+""}}(h[0].x):function(t){return function(){return t}}(n):(n=h.length,function(t){for(var e,i=0;i<n;++i)s[(e=h[i]).i]=e.x(t);return s.join("")})}function it(t,n){var e,i=typeof n;return null==n||"boolean"===i?G(n):("number"===i?K:"string"===i?(e=P(n))?(n=e,O):et:n instanceof P?O:n instanceof Date?W:Y(n)?_:Array.isArray(n)?J:"function"!=typeof n.valueOf&&"function"!=typeof n.toString||isNaN(n)?Q:K)(t,n)}function rt(t,n){return t=+t,n=+n,function(e){return Math.round(t*(1-e)+n*e)}}function at(t){return+t}var ot=[0,1];function st(t){return t}function ht(t,n){return(n-=t=+t)?function(e){return(e-t)/n}:(e=isNaN(n)?NaN:.5,function(){return e});var e}function lt(t,n,e){var i=t[0],r=t[1],a=n[0],o=n[1];return r<i?(i=ht(r,i),a=e(o,a)):(i=ht(i,r),a=e(a,o)),function(t){return a(i(t))}}function ut(t,n,e){var i=Math.min(t.length,n.length)-1,r=new Array(i),a=new Array(i),o=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),n=n.slice().reverse());++o<i;)r[o]=ht(t[o],t[o+1]),a[o]=e(n[o],n[o+1]);return function(n){var e=u(t,n,1,i)-1;return a[e](r[e](n))}}function ct(){var t,n,e,i,r,a,o=ot,s=ot,h=it,l=st;function u(){var t,n,e,h=Math.min(o.length,s.length);return l!==st&&(t=o[0],n=o[h-1],t>n&&(e=t,t=n,n=e),l=function(e){return Math.max(t,Math.min(n,e))}),i=h>2?ut:lt,r=a=null,c}function c(n){return null==n||isNaN(n=+n)?e:(r||(r=i(o.map(t),s,h)))(t(l(n)))}return c.invert=function(e){return l(n((a||(a=i(s,o.map(t),K)))(e)))},c.domain=function(t){return arguments.length?(o=Array.from(t,at),u()):o.slice()},c.range=function(t){return arguments.length?(s=Array.from(t),u()):s.slice()},c.rangeRound=function(t){return s=Array.from(t),h=rt,u()},c.clamp=function(t){return arguments.length?(l=!!t||st,u()):l!==st},c.interpolate=function(t){return arguments.length?(h=t,u()):h},c.unknown=function(t){return arguments.length?(e=t,c):e},function(e,i){return t=e,n=i,u()}}function dt(t,n){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(n).domain(t)}return this}function pt(t,n){if((e=(t=n?t.toExponential(n-1):t.toExponential()).indexOf("e"))<0)return null;var e,i=t.slice(0,e);return[i.length>1?i[0]+i.slice(2):i,+t.slice(e+1)]}function ft(t){return(t=pt(Math.abs(t)))?t[1]:NaN}function gt(t){return function(n){return n.replace(/[0-9]/g,(function(n){return t[+n]}))}}var vt,mt=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function bt(t){if(!(n=mt.exec(t)))throw new Error("invalid format: "+t);var n;return new yt({fill:n[1],align:n[2],sign:n[3],symbol:n[4],zero:n[5],width:n[6],comma:n[7],precision:n[8]&&n[8].slice(1),trim:n[9],type:n[10]})}function yt(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function wt(t){t:for(var n,e=t.length,i=1,r=-1;i<e;++i)switch(t[i]){case".":r=n=i;break;case"0":0===r&&(r=i),n=i;break;default:if(!+t[i])break t;r>0&&(r=0)}return r>0?t.slice(0,r)+t.slice(n+1):t}function kt(t,n){var e=pt(t,n);if(!e)return t+"";var i=e[0],r=e[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}bt.prototype=yt.prototype,yt.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var xt={"%":(t,n)=>(100*t).toFixed(n),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,n)=>t.toExponential(n),f:(t,n)=>t.toFixed(n),g:(t,n)=>t.toPrecision(n),o:t=>Math.round(t).toString(8),p:(t,n)=>kt(100*t,n),r:kt,s:function(t,n){var e=pt(t,n);if(!e)return t+"";var i=e[0],r=e[1],a=r-(vt=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,o=i.length;return a===o?i:a>o?i+new Array(a-o+1).join("0"):a>0?i.slice(0,a)+"."+i.slice(a):"0."+new Array(1-a).join("0")+pt(t,Math.max(0,n+a-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Mt(t){return t}var Nt,St,Et,Ct=Array.prototype.map,At=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Pt(t){var n,e,i=void 0===t.grouping||void 0===t.thousands?Mt:(n=Ct.call(t.grouping,Number),e=t.thousands+"",function(t,i){for(var r=t.length,a=[],o=0,s=n[0],h=0;r>0&&s>0&&(h+s+1>i&&(s=Math.max(1,i-h)),a.push(t.substring(r-=s,r+s)),!((h+=s+1)>i));)s=n[o=(o+1)%n.length];return a.reverse().join(e)}),r=void 0===t.currency?"":t.currency[0]+"",a=void 0===t.currency?"":t.currency[1]+"",o=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?Mt:gt(Ct.call(t.numerals,String)),h=void 0===t.percent?"%":t.percent+"",l=void 0===t.minus?"−":t.minus+"",u=void 0===t.nan?"NaN":t.nan+"";function c(t){var n=(t=bt(t)).fill,e=t.align,c=t.sign,d=t.symbol,p=t.zero,f=t.width,g=t.comma,v=t.precision,m=t.trim,b=t.type;"n"===b?(g=!0,b="g"):xt[b]||(void 0===v&&(v=12),m=!0,b="g"),(p||"0"===n&&"="===e)&&(p=!0,n="0",e="=");var y="$"===d?r:"#"===d&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",w="$"===d?a:/[%p]/.test(b)?h:"",k=xt[b],x=/[defgprs%]/.test(b);function M(t){var r,a,h,d=y,M=w;if("c"===b)M=k(t)+M,t="";else{var N=(t=+t)<0||1/t<0;if(t=isNaN(t)?u:k(Math.abs(t),v),m&&(t=wt(t)),N&&0==+t&&"+"!==c&&(N=!1),d=(N?"("===c?c:l:"-"===c||"("===c?"":c)+d,M=("s"===b?At[8+vt/3]:"")+M+(N&&"("===c?")":""),x)for(r=-1,a=t.length;++r<a;)if(48>(h=t.charCodeAt(r))||h>57){M=(46===h?o+t.slice(r+1):t.slice(r))+M,t=t.slice(0,r);break}}g&&!p&&(t=i(t,1/0));var S=d.length+t.length+M.length,E=S<f?new Array(f-S+1).join(n):"";switch(g&&p&&(t=i(E+t,E.length?f-M.length:1/0),E=""),e){case"<":t=d+t+M+E;break;case"=":t=d+E+t+M;break;case"^":t=E.slice(0,S=E.length>>1)+d+t+M+E.slice(S);break;default:t=E+d+t+M}return s(t)}return v=void 0===v?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v)),M.toString=function(){return t+""},M}return{format:c,formatPrefix:function(t,n){var e=c(((t=bt(t)).type="f",t)),i=3*Math.max(-8,Math.min(8,Math.floor(ft(n)/3))),r=Math.pow(10,-i),a=At[8+i/3];return function(t){return e(r*t)+a}}}}function It(t){return Math.max(0,-ft(Math.abs(t)))}function Ht(t,n){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(ft(n)/3)))-ft(Math.abs(t)))}function Ft(t,n){return t=Math.abs(t),n=Math.abs(n)-t,Math.max(0,ft(n)-ft(t))+1}function Rt(t,n,e,i){var r,o=a(t,n,e);switch((i=bt(null==i?",f":i)).type){case"s":var s=Math.max(Math.abs(t),Math.abs(n));return null!=i.precision||isNaN(r=Ht(o,s))||(i.precision=r),Et(i,s);case"":case"e":case"g":case"p":case"r":null!=i.precision||isNaN(r=Ft(o,Math.max(Math.abs(t),Math.abs(n))))||(i.precision=r-("e"===i.type));break;case"f":case"%":null!=i.precision||isNaN(r=It(o))||(i.precision=r-2*("%"===i.type))}return St(i)}function Lt(t){var n=t.domain;return t.ticks=function(t){var e=n();return i(e[0],e[e.length-1],null==t?10:t)},t.tickFormat=function(t,e){var i=n();return Rt(i[0],i[i.length-1],null==t?10:t,e)},t.nice=function(e){null==e&&(e=10);var i,a,o=n(),s=0,h=o.length-1,l=o[s],u=o[h],c=10;for(u<l&&(a=l,l=u,u=a,a=s,s=h,h=a);c-- >0;){if((a=r(l,u,e))===i)return o[s]=l,o[h]=u,n(o);if(a>0)l=Math.floor(l/a)*a,u=Math.ceil(u/a)*a;else{if(!(a<0))break;l=Math.ceil(l*a)/a,u=Math.floor(u*a)/a}i=a}return t},t}function $t(){var t=ct()(st,st);return t.copy=function(){return n=t,$t().domain(n.domain()).range(n.range()).interpolate(n.interpolate()).clamp(n.clamp()).unknown(n.unknown());var n},dt.apply(t,arguments),Lt(t)}function qt(t,n,e){t.prototype=n.prototype=e,e.constructor=t}function Vt(t,n){var e=Object.create(t.prototype);for(var i in n)e[i]=n[i];return e}function Ut(){}Nt=Pt({thousands:",",grouping:[3],currency:["$",""]}),St=Nt.format,Et=Nt.formatPrefix;var Xt=.7,Tt=1.4285714285714286,zt="\\s*([+-]?\\d+)\\s*",Gt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Bt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Dt=/^#([0-9a-f]{3,8})$/,jt=new RegExp(`^rgb\\(${zt},${zt},${zt}\\)$`),Ot=new RegExp(`^rgb\\(${Bt},${Bt},${Bt}\\)$`),Zt=new RegExp(`^rgba\\(${zt},${zt},${zt},${Gt}\\)$`),_t=new RegExp(`^rgba\\(${Bt},${Bt},${Bt},${Gt}\\)$`),Yt=new RegExp(`^hsl\\(${Gt},${Bt},${Bt}\\)$`),Jt=new RegExp(`^hsla\\(${Gt},${Bt},${Bt},${Gt}\\)$`),Wt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Kt(){return this.rgb().formatHex()}function Qt(){return this.rgb().formatRgb()}function tn(t){var n,e;return t=(t+"").trim().toLowerCase(),(n=Dt.exec(t))?(e=n[1].length,n=parseInt(n[1],16),6===e?nn(n):3===e?new an(n>>8&15|n>>4&240,n>>4&15|240&n,(15&n)<<4|15&n,1):8===e?en(n>>24&255,n>>16&255,n>>8&255,(255&n)/255):4===e?en(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|240&n,((15&n)<<4|15&n)/255):null):(n=jt.exec(t))?new an(n[1],n[2],n[3],1):(n=Ot.exec(t))?new an(255*n[1]/100,255*n[2]/100,255*n[3]/100,1):(n=Zt.exec(t))?en(n[1],n[2],n[3],n[4]):(n=_t.exec(t))?en(255*n[1]/100,255*n[2]/100,255*n[3]/100,n[4]):(n=Yt.exec(t))?cn(n[1],n[2]/100,n[3]/100,1):(n=Jt.exec(t))?cn(n[1],n[2]/100,n[3]/100,n[4]):Wt.hasOwnProperty(t)?nn(Wt[t]):"transparent"===t?new an(NaN,NaN,NaN,0):null}function nn(t){return new an(t>>16&255,t>>8&255,255&t,1)}function en(t,n,e,i){return i<=0&&(t=n=e=NaN),new an(t,n,e,i)}function rn(t,n,e,i){return 1===arguments.length?((r=t)instanceof Ut||(r=tn(r)),r?new an((r=r.rgb()).r,r.g,r.b,r.opacity):new an):new an(t,n,e,null==i?1:i);var r}function an(t,n,e,i){this.r=+t,this.g=+n,this.b=+e,this.opacity=+i}function on(){return`#${un(this.r)}${un(this.g)}${un(this.b)}`}function sn(){const t=hn(this.opacity);return`${1===t?"rgb(":"rgba("}${ln(this.r)}, ${ln(this.g)}, ${ln(this.b)}${1===t?")":`, ${t})`}`}function hn(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function ln(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function un(t){return((t=ln(t))<16?"0":"")+t.toString(16)}function cn(t,n,e,i){return i<=0?t=n=e=NaN:e<=0||e>=1?t=n=NaN:n<=0&&(t=NaN),new fn(t,n,e,i)}function dn(t){if(t instanceof fn)return new fn(t.h,t.s,t.l,t.opacity);if(t instanceof Ut||(t=tn(t)),!t)return new fn;if(t instanceof fn)return t;var n=(t=t.rgb()).r/255,e=t.g/255,i=t.b/255,r=Math.min(n,e,i),a=Math.max(n,e,i),o=NaN,s=a-r,h=(a+r)/2;return s?(o=n===a?(e-i)/s+6*(e<i):e===a?(i-n)/s+2:(n-e)/s+4,s/=h<.5?a+r:2-a-r,o*=60):s=h>0&&h<1?0:o,new fn(o,s,h,t.opacity)}function pn(t,n,e,i){return 1===arguments.length?dn(t):new fn(t,n,e,null==i?1:i)}function fn(t,n,e,i){this.h=+t,this.s=+n,this.l=+e,this.opacity=+i}function gn(t){return(t=(t||0)%360)<0?t+360:t}function vn(t){return Math.max(0,Math.min(1,t||0))}function mn(t,n,e){return 255*(t<60?n+(e-n)*t/60:t<180?e:t<240?n+(e-n)*(240-t)/60:n)}qt(Ut,tn,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Kt,formatHex:Kt,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return dn(this).formatHsl()},formatRgb:Qt,toString:Qt}),qt(an,rn,Vt(Ut,{brighter(t){return t=null==t?Tt:Math.pow(Tt,t),new an(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?Xt:Math.pow(Xt,t),new an(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new an(ln(this.r),ln(this.g),ln(this.b),hn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:on,formatHex:on,formatHex8:function(){return`#${un(this.r)}${un(this.g)}${un(this.b)}${un(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:sn,toString:sn})),qt(fn,pn,Vt(Ut,{brighter(t){return t=null==t?Tt:Math.pow(Tt,t),new fn(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?Xt:Math.pow(Xt,t),new fn(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),n=isNaN(t)||isNaN(this.s)?0:this.s,e=this.l,i=e+(e<.5?e:1-e)*n,r=2*e-i;return new an(mn(t>=240?t-240:t+120,r,i),mn(t,r,i),mn(t<120?t+240:t-120,r,i),this.opacity)},clamp(){return new fn(gn(this.h),vn(this.s),vn(this.l),hn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=hn(this.opacity);return`${1===t?"hsl(":"hsla("}${gn(this.h)}, ${100*vn(this.s)}%, ${100*vn(this.l)}%${1===t?")":`, ${t})`}`}}));var bn=t=>()=>t;function yn(t,n){return function(e){return t+e*n}}function wn(t,n){var e=n-t;return e?yn(t,e):bn(isNaN(t)?n:t)}function kn(t){return function(n,e){var i=t((n=pn(n)).h,(e=pn(e)).h),r=wn(n.s,e.s),a=wn(n.l,e.l),o=wn(n.opacity,e.opacity);return function(t){return n.h=i(t),n.s=r(t),n.l=a(t),n.opacity=o(t),n+""}}}kn((function(t,n){var e=n-t;return e?yn(t,e>180||e<-180?e-360*Math.round(e/360):e):bn(isNaN(t)?n:t)}));var xn=kn(wn);function Mn(t,n){return t=+t,n=+n,function(e){return t*(1-e)+n*e}}function Nn(t,n,e){t.prototype=n.prototype=e,e.constructor=t}function Sn(t,n){var e=Object.create(t.prototype);for(var i in n)e[i]=n[i];return e}function En(){}var Cn=.7,An=1.4285714285714286,Pn="\\s*([+-]?\\d+)\\s*",In="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Hn="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Fn=/^#([0-9a-f]{3,8})$/,Rn=new RegExp("^rgb\\("+[Pn,Pn,Pn]+"\\)$"),Ln=new RegExp("^rgb\\("+[Hn,Hn,Hn]+"\\)$"),$n=new RegExp("^rgba\\("+[Pn,Pn,Pn,In]+"\\)$"),qn=new RegExp("^rgba\\("+[Hn,Hn,Hn,In]+"\\)$"),Vn=new RegExp("^hsl\\("+[In,Hn,Hn]+"\\)$"),Un=new RegExp("^hsla\\("+[In,Hn,Hn,In]+"\\)$"),Xn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Tn(){return this.rgb().formatHex()}function zn(){return this.rgb().formatRgb()}function Gn(t){var n,e;return t=(t+"").trim().toLowerCase(),(n=Fn.exec(t))?(e=n[1].length,n=parseInt(n[1],16),6===e?Bn(n):3===e?new On(n>>8&15|n>>4&240,n>>4&15|240&n,(15&n)<<4|15&n,1):8===e?Dn(n>>24&255,n>>16&255,n>>8&255,(255&n)/255):4===e?Dn(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|240&n,((15&n)<<4|15&n)/255):null):(n=Rn.exec(t))?new On(n[1],n[2],n[3],1):(n=Ln.exec(t))?new On(255*n[1]/100,255*n[2]/100,255*n[3]/100,1):(n=$n.exec(t))?Dn(n[1],n[2],n[3],n[4]):(n=qn.exec(t))?Dn(255*n[1]/100,255*n[2]/100,255*n[3]/100,n[4]):(n=Vn.exec(t))?Jn(n[1],n[2]/100,n[3]/100,1):(n=Un.exec(t))?Jn(n[1],n[2]/100,n[3]/100,n[4]):Xn.hasOwnProperty(t)?Bn(Xn[t]):"transparent"===t?new On(NaN,NaN,NaN,0):null}function Bn(t){return new On(t>>16&255,t>>8&255,255&t,1)}function Dn(t,n,e,i){return i<=0&&(t=n=e=NaN),new On(t,n,e,i)}function jn(t,n,e,i){return 1===arguments.length?((r=t)instanceof En||(r=Gn(r)),r?new On((r=r.rgb()).r,r.g,r.b,r.opacity):new On):new On(t,n,e,null==i?1:i);var r}function On(t,n,e,i){this.r=+t,this.g=+n,this.b=+e,this.opacity=+i}function Zn(){return"#"+Yn(this.r)+Yn(this.g)+Yn(this.b)}function _n(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function Yn(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function Jn(t,n,e,i){return i<=0?t=n=e=NaN:e<=0||e>=1?t=n=NaN:n<=0&&(t=NaN),new Kn(t,n,e,i)}function Wn(t){if(t instanceof Kn)return new Kn(t.h,t.s,t.l,t.opacity);if(t instanceof En||(t=Gn(t)),!t)return new Kn;if(t instanceof Kn)return t;var n=(t=t.rgb()).r/255,e=t.g/255,i=t.b/255,r=Math.min(n,e,i),a=Math.max(n,e,i),o=NaN,s=a-r,h=(a+r)/2;return s?(o=n===a?(e-i)/s+6*(e<i):e===a?(i-n)/s+2:(n-e)/s+4,s/=h<.5?a+r:2-a-r,o*=60):s=h>0&&h<1?0:o,new Kn(o,s,h,t.opacity)}function Kn(t,n,e,i){this.h=+t,this.s=+n,this.l=+e,this.opacity=+i}function Qn(t,n,e){return 255*(t<60?n+(e-n)*t/60:t<180?e:t<240?n+(e-n)*(240-t)/60:n)}Nn(En,Gn,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:Tn,formatHex:Tn,formatHsl:function(){return Wn(this).formatHsl()},formatRgb:zn,toString:zn}),Nn(On,jn,Sn(En,{brighter:function(t){return t=null==t?An:Math.pow(An,t),new On(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?Cn:Math.pow(Cn,t),new On(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Zn,formatHex:Zn,formatRgb:_n,toString:_n})),Nn(Kn,(function(t,n,e,i){return 1===arguments.length?Wn(t):new Kn(t,n,e,null==i?1:i)}),Sn(En,{brighter:function(t){return t=null==t?An:Math.pow(An,t),new Kn(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?Cn:Math.pow(Cn,t),new Kn(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),n=isNaN(t)||isNaN(this.s)?0:this.s,e=this.l,i=e+(e<.5?e:1-e)*n,r=2*e-i;return new On(Qn(t>=240?t-240:t+120,r,i),Qn(t,r,i),Qn(t<120?t+240:t-120,r,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var te=1/.7;function ne(t,n,e,i){return 1===arguments.length?function(t){if(t instanceof ee)return new ee(t.h,t.s,t.v,t.opacity);t instanceof jn||(t=jn(t));var n=t.r/255,e=t.g/255,i=t.b/255,r=Math.min(n,e,i),a=Math.max(n,e,i),o=a-r,s=NaN;return o&&(s=n===a?(e-i)/o+6*(e<i):e===a?(i-n)/o+2:(n-e)/o+4,s*=60),new ee(s,o/a,a,t.opacity)}(t):new ee(t,n,e,null==i?1:i)}function ee(t,n,e,i){this.h=+t,this.s=+n,this.v=+e,this.opacity=+i}var ie=ee.prototype=ne.prototype=Object.create(Gn.prototype);function re(t,n,e,i,r){return jn(255*(t+i),255*(n+i),255*(e+i),r)}function ae(t){return function(){return t}}function oe(t,n){return function(e){return t+e*n}}function se(t,n){var e=n-t;return e?oe(t,e):ae(isNaN(t)?n:t)}function he(t){return function(n,e){var i=t((n=ne(n)).h,(e=ne(e)).h),r=se(n.s,e.s),a=se(n.v,e.v),o=se(n.opacity,e.opacity);return function(t){return n.h=i(t),n.s=r(t),n.v=a(t),n.opacity=o(t),n+""}}}ie.constructor=ee,ie.brighter=function(t){return t=null==t?te:Math.pow(te,t),new ee(this.h,this.s,this.v*t,this.opacity)},ie.darker=function(t){return t=null==t?.7:Math.pow(.7,t),new ee(this.h,this.s,this.v*t,this.opacity)},ie.rgb=function(){var t=isNaN(this.h)?0:this.h%360+360*(this.h<0),n=isNaN(this.h)||isNaN(this.s)?0:this.s,e=this.v,i=this.opacity,r=e*n,a=r*(1-Math.abs(t/60%2-1)),o=e-r;return t<60?re(r,a,0,o,i):t<120?re(a,r,0,o,i):t<180?re(0,r,a,o,i):t<240?re(0,a,r,o,i):t<300?re(a,0,r,o,i):re(r,0,a,o,i)},ie.displayable=function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.v&&this.v<=1&&0<=this.opacity&&this.opacity<=1};he((function(t,n){var e=n-t;return e?oe(t,e>180||e<-180?e-360*Math.round(e/360):e):ae(isNaN(t)?n:t)})),he(se);document.head.innerHTML+="<style>\n    .tfe-color-picker-root {\n        display: flex;\n        justify-content: center;\n    }\n\n    .tfe-color-picker-sl-picker {\n        border: 1px solid grey;\n    }\n\n    .tfe-color-picker-h-picker {\n        width: 18px;\n        margin-left: 12px;\n        border: 1px solid grey;\n    }\n\n    .tfe-color-picker-input-root {\n        display: grid;\n        grid-template-columns: 36px 60px;\n        grid-template-rows: repeat(3, auto) 20px repeat(3, auto) 20px auto;\n        grid-column-gap: 6px;\n        grid-row-gap: 6px;\n        align-items: center;\n        align-content: space-evenly;\n        margin-left: 12px;\n        margin-bottom: 0;\n    }\n\n    .tfe-color-preview {\n        grid-column: 1 / span 2;\n        height: 50px;\n        border: 1px solid grey;\n    }\n\n    .tfe-color-picker-input-root > label {\n        text-align: right;\n    }\n\n    .tfe-color-picker-input-root > input {\n        text-align: right;\n        font-family: monospace;\n    }\n\n    .tfe-color-picker-input-hex-invalid:focus-visible {\n        outline-color: red;\n    }\n</style>";var le=function(){function t(t,n){if(this.container=void 0,this.hsv=void 0,this.backUpHue=void 0,this.backUpSaturation=void 0,this.svCanvas=void 0,this.svContext=void 0,this.hCanvas=void 0,this.hContext=void 0,this.CANVAS_SIZE=256,this.controlPointSize=7,this.callback=void 0,this.inputFields=void 0,this.previewElement=void 0,!t)throw"No element given!";this.container="string"==typeof t?document.querySelector(t):t,this.hsv=ne((null==n?void 0:n.initialColor)||"#FFF"),Number.isNaN(this.hsv.h)&&(this.hsv.h=180),Number.isNaN(this.hsv.s)&&(this.hsv.s=1),this.backUpHue=this.hsv.h,this.backUpSaturation=this.hsv.s,this.container.classList.add("tfe-color-picker"),this.container.innerHTML='\n<div class="tfe-color-picker-root">\n  <div class="tfe-color-picker-sl-picker" style="width: '+this.CANVAS_SIZE+"px; height: "+this.CANVAS_SIZE+'px">\n    <canvas class="tfe-color-picker-sl-picker-canvas" width="'+this.CANVAS_SIZE+'" height="'+this.CANVAS_SIZE+'" />\n  </div>\n  <div class="tfe-color-picker-h-picker"  style="height: '+this.CANVAS_SIZE+'px">\n    <canvas class="tfe-color-picker-h-picker-canvas" width="18" height="'+this.CANVAS_SIZE+'" />\n  </div>\n  <form class="tfe-color-picker-input-root">\n    <div class="tfe-color-preview" style="background: '+this.getHEX()+'"></div>\n\n    <div></div>\n    <div></div>\n\n    <label for="h">h:</label>\n    <input class="tfe-color-picker-h-input" name="h" type="number" min="0" max="360" step="1" value="'+this.hsv.h.toFixed(0)+'">\n\n    <label for="s">s:</label>\n    <input class="tfe-color-picker-s-input" name="s" type="number" min="0" max="100" step="1" value="'+(100*this.hsv.s).toFixed(0)+'">\n\n    <label for="v">v:</label>\n    <input class="tfe-color-picker-v-input" name="v" type="number" min="0" max="100" step="1" value="'+(100*this.hsv.v).toFixed(0)+'">\n\n    <div></div>\n    <div></div>\n\n    <label for="r">r:</label>\n    <input class="tfe-color-picker-r-input" name="r" type="number" min="0" max="255" step="1" value="'+this.hsv.rgb().r.toFixed(0)+'">\n\n    <label for="g">g:</label>\n    <input class="tfe-color-picker-g-input" name="g" type="number" min="0" max="255" step="1" value="'+this.hsv.rgb().g.toFixed(0)+'">\n\n    <label for="b">b:</label>\n    <input class="tfe-color-picker-b-input" name="b" type="number" min="0" max="255" step="1" value="'+this.hsv.rgb().b.toFixed(0)+'">\n\n    <div></div>\n    <div></div>\n\n    <label for="hex">hex:</label>\n    <input class="tfe-color-picker-hex-input" name="hex" type="text" minlength="4" maxlength="7" value="'+this.getHEX()+'">\n  </form>\n</div>        \n        ',this.svCanvas=this.container.querySelector(".tfe-color-picker-sl-picker-canvas"),this.svContext=this.svCanvas.getContext("2d",{alpha:!1}),this.drawSVPicker(),this.addSVEventListener(),this.hCanvas=this.container.querySelector(".tfe-color-picker-h-picker-canvas"),this.hContext=this.hCanvas.getContext("2d",{alpha:!1}),this.drawHPicker(),this.addHEventListener(),this.inputFields={h:this.container.querySelector(".tfe-color-picker-h-input"),s:this.container.querySelector(".tfe-color-picker-s-input"),v:this.container.querySelector(".tfe-color-picker-v-input"),r:this.container.querySelector(".tfe-color-picker-r-input"),g:this.container.querySelector(".tfe-color-picker-g-input"),b:this.container.querySelector(".tfe-color-picker-b-input"),hex:this.container.querySelector(".tfe-color-picker-hex-input")},this.addInputEventListeners(),this.previewElement=this.container.querySelector(".tfe-color-preview")}var n=t.prototype;return n.onChange=function(t){this.callback=t;var n=this.getRGB(),e=this.getHSL(),i=this.getHSV();this.callback({rgb:n,hsl:e,hsv:i,hex:this.getHEX()})},n.sendUpdate=function(){var t=this.getHEX();if(this.previewElement.style.backgroundColor=t,this.callback){var n=this.getRGB(),e=this.getHSL(),i=this.getHSV();this.callback({rgb:n,hsl:e,hsv:i,hex:t})}},n.setHEX=function(t){this.hsv=ne(t),this.validateHueAndSaturation(),this.sendUpdate(),this.drawAll()},n.setRGB=function(t,n,e){this.hsv=ne("rgb("+255*t+","+255*n+","+255*e+")"),this.validateHueAndSaturation(),this.sendUpdate(),this.drawAll()},n.setHSL=function(t,n,e){this.hsv=ne("hsl("+360*t+" "+100*n+" "+100*e+")"),this.validateHueAndSaturation(),this.sendUpdate(),this.drawAll()},n.setHSV=function(t,n,e){this.hsv=ne(t,n,e),this.validateHueAndSaturation(),this.sendUpdate(),this.drawAll()},n.getHEX=function(){return this.formatHSV(this.hsv)},n.getRGB=function(){var t=this.hsv.rgb();return{r:t.r,g:t.g,b:t.b}},n.getHSL=function(){var t=pn(this.hsv.formatHsl());return{h:t.h,s:t.s,l:t.l}},n.getHSV=function(){return{h:this.hsv.h,s:this.hsv.s,v:this.hsv.v}},n.drawAll=function(){this.drawHPicker(),this.drawSVPicker()},n.drawSVPicker=function(){for(var t=0;t<this.CANVAS_SIZE;t++){var n=this.svContext.createLinearGradient(0,0,0,this.CANVAS_SIZE);n.addColorStop(0,ne(this.hsv.h,t/this.CANVAS_SIZE,1).formatHex()),n.addColorStop(1,ne(this.hsv.h,t/this.CANVAS_SIZE,0).formatHex()),this.svContext.fillStyle=n,this.svContext.fillRect(t,0,1,this.CANVAS_SIZE)}for(var e=this.hsv.s*this.CANVAS_SIZE,i=(1-this.hsv.v)*this.CANVAS_SIZE,r=0;r<10;r++)this.svContext.beginPath(),this.svContext.strokeStyle=r%2==0?"white":"black",this.svContext.arc(e,i,this.controlPointSize,r/10*(2*Math.PI),(r+1)/10*(2*Math.PI)),this.svContext.stroke()},n.drawHPicker=function(){var t=this.hContext.createLinearGradient(0,0,0,this.hCanvas.height);t.addColorStop(0,"#ff0000"),t.addColorStop(1/6,"#ffff00"),t.addColorStop(2/6,"#00ff00"),t.addColorStop(.5,"#00ffff"),t.addColorStop(4/6,"#0000ff"),t.addColorStop(5/6,"#ff00ff"),t.addColorStop(1,"#ff0000"),this.hContext.fillStyle=t,this.hContext.fillRect(0,0,this.hCanvas.width,this.hCanvas.height);for(var n=this.hCanvas.width/2,e=this.hsv.h/360*this.hCanvas.height,i=0;i<10;i++)this.hContext.beginPath(),this.hContext.strokeStyle=i%2==0?"white":"black",this.hContext.arc(n,e,this.controlPointSize,i/10*(2*Math.PI),(i+1)/10*(2*Math.PI)),this.hContext.stroke()},n.addSVEventListener=function(){var t=this,n=!1,e=function(n,e){t.hsv.s=ue(n/t.CANVAS_SIZE,0,1),t.backUpSaturation=t.hsv.s,t.hsv.v=ue(1-e/t.CANVAS_SIZE,0,1),t.sendUpdate(),t.drawSVPicker(),t.updateHSVInputFields(),t.updateRGBInputFields(),t.updateHEXInputField()};this.svCanvas.addEventListener("mousedown",(function(t){n=!0,e(t.offsetX,t.offsetY)})),this.svCanvas.addEventListener("mousemove",(function(t){n&&e(t.offsetX,t.offsetY)})),this.svCanvas.addEventListener("mouseleave",(function(t){n&&e(t.offsetX,t.offsetY),n=!1})),this.svCanvas.addEventListener("mouseup",(function(t){return n=!1}))},n.addHEventListener=function(){var t=this,n=!1,e=function(n){t.hsv.h=ue(Math.round(n/t.CANVAS_SIZE*360),0,360),t.backUpHue=t.hsv.h,t.sendUpdate(),t.drawAll(),t.inputFields.h.valueAsNumber=Math.round(t.hsv.h),t.updateRGBInputFields(),t.updateHEXInputField()};this.hCanvas.addEventListener("mousedown",(function(t){n=!0,e(t.offsetY)})),this.hCanvas.addEventListener("mousemove",(function(t){n&&e(t.offsetY)})),this.hCanvas.addEventListener("mouseleave",(function(t){n&&e(t.offsetY),n=!1})),this.hCanvas.addEventListener("mouseup",(function(t){return n=!1}))},n.addInputEventListeners=function(){var t=this,n=function(t,n,e){return t.valueAsNumber<n?t.valueAsNumber=n:t.valueAsNumber>e&&(t.valueAsNumber=e),Number.isFinite(t.valueAsNumber)?t.valueAsNumber:null},e=function(t,e,i){return null===n(t,e,i)?(t.valueAsNumber=e,e):null};this.inputFields.h.addEventListener("input",(function(e){var i=n(e.currentTarget,0,360);null!==i&&(t.hsv.h=i,t.backUpHue=t.hsv.h,t.sendUpdate(),t.drawAll(),t.updateRGBInputFields(),t.updateHEXInputField())}));var i=function(n){var i=e(n.currentTarget,0,360);null!==i&&(t.hsv.h=i,t.backUpHue=t.hsv.h,t.sendUpdate(),t.drawAll(),t.updateRGBInputFields(),t.updateHEXInputField())};this.inputFields.h.addEventListener("focusout",i),this.inputFields.h.addEventListener("keypress",(function(t){"Enter"===t.key&&i(t)})),this.inputFields.s.addEventListener("input",(function(e){var i=n(e.currentTarget,0,100);null!==i&&(t.hsv.s=i/100,t.backUpSaturation=t.hsv.s,t.sendUpdate(),t.drawSVPicker(),t.updateRGBInputFields(),t.updateHEXInputField())}));var r=function(n){var i=e(n.currentTarget,0,100);null!==i&&(t.hsv.s=i,t.backUpSaturation=t.hsv.s,t.sendUpdate(),t.drawAll(),t.updateRGBInputFields(),t.updateHEXInputField())};this.inputFields.s.addEventListener("focusout",r),this.inputFields.s.addEventListener("keypress",(function(t){"Enter"===t.key&&r(t)})),this.inputFields.v.addEventListener("input",(function(e){var i=n(e.currentTarget,0,100);null!==i&&(t.hsv.v=i/100,t.sendUpdate(),t.drawSVPicker(),t.updateRGBInputFields(),t.updateHEXInputField())}));var a=function(n){var i=e(n.currentTarget,0,100);null!==i&&(t.hsv.v=i,t.sendUpdate(),t.drawAll(),t.updateRGBInputFields(),t.updateHEXInputField())};this.inputFields.v.addEventListener("focusout",a),this.inputFields.v.addEventListener("keypress",(function(t){"Enter"===t.key&&a(t)})),this.inputFields.r.addEventListener("input",(function(e){var i=n(e.currentTarget,0,255);if(null!==i){var r=t.hsv.rgb();t.hsv=ne("rgb("+Math.round(i)+","+Math.round(r.g)+","+Math.round(r.b)+")"),t.validateHueAndSaturation(),t.sendUpdate(),t.drawAll(),t.updateHSVInputFields(),t.updateHEXInputField()}}));var o=function(n){var i=e(n.currentTarget,0,255);if(null!==i){var r=t.hsv.rgb();t.hsv=ne("rgb("+Math.round(i)+","+Math.round(r.g)+","+Math.round(r.b)+")"),t.validateHueAndSaturation(),t.sendUpdate(),t.drawAll(),t.updateHSVInputFields(),t.updateHEXInputField()}};this.inputFields.r.addEventListener("focusout",o),this.inputFields.r.addEventListener("keypress",(function(t){"Enter"===t.key&&o(t)})),this.inputFields.g.addEventListener("input",(function(e){var i=n(e.currentTarget,0,255);if(null!==i){var r=t.hsv.rgb();t.hsv=ne("rgb("+Math.round(r.r)+","+Math.round(i)+","+Math.round(r.b)+")"),t.validateHueAndSaturation(),t.sendUpdate(),t.drawAll(),t.updateHSVInputFields(),t.updateHEXInputField()}}));var s=function(n){var i=e(n.currentTarget,0,255);if(null!==i){var r=t.hsv.rgb();t.hsv=ne("rgb("+Math.round(r.r)+","+Math.round(i)+","+Math.round(r.b)+")"),t.validateHueAndSaturation(),t.sendUpdate(),t.drawAll(),t.updateHSVInputFields(),t.updateHEXInputField()}};this.inputFields.g.addEventListener("focusout",s),this.inputFields.g.addEventListener("keypress",(function(t){"Enter"===t.key&&s(t)})),this.inputFields.b.addEventListener("input",(function(e){var i=n(e.currentTarget,0,255);if(null!==i){var r=t.hsv.rgb();t.hsv=ne("rgb("+Math.round(r.r)+","+Math.round(r.g)+","+Math.round(i)+")"),t.validateHueAndSaturation(),t.sendUpdate(),t.drawAll(),t.updateHSVInputFields(),t.updateHEXInputField()}}));var h=function(n){var i=e(n.currentTarget,0,255);if(null!==i){var r=t.hsv.rgb();t.hsv=ne("rgb("+Math.round(r.r)+","+Math.round(r.g)+","+Math.round(i)+")"),t.validateHueAndSaturation(),t.sendUpdate(),t.drawAll(),t.updateHSVInputFields(),t.updateHEXInputField()}};this.inputFields.b.addEventListener("focusout",h),this.inputFields.b.addEventListener("keypress",(function(t){"Enter"===t.key&&h(t)})),this.inputFields.hex.addEventListener("input",(function(n){var e=n.currentTarget,i=e.value;i.match(/#([0-7a-fA-F]{3}$|[0-7a-fA-F]{6}$)/)?(t.hsv=ne(i),t.validateHueAndSaturation(),t.sendUpdate(),t.drawAll(),t.updateRGBInputFields(),t.updateHSVInputFields(),e.classList.remove("tfe-color-picker-input-hex-invalid")):e.classList.add("tfe-color-picker-input-hex-invalid")})),this.inputFields.hex.addEventListener("focusout",(function(n){var e=n.currentTarget;e.value.match(/#([0-7a-fA-F]{3}$|[0-7a-fA-F]{6}$)/)||(e.value=t.getHEX(),e.classList.remove("tfe-color-picker-input-hex-invalid"))}))},n.updateHSVInputFields=function(){this.inputFields.h.valueAsNumber=ue(Math.round(this.hsv.h),0,360),this.inputFields.s.valueAsNumber=ue(Math.round(100*this.hsv.s),0,100),this.inputFields.v.valueAsNumber=ue(Math.round(100*this.hsv.v),0,100)},n.updateRGBInputFields=function(){var t=this.hsv.rgb();this.inputFields.r.valueAsNumber=ue(Math.round(t.r),0,255),this.inputFields.g.valueAsNumber=ue(Math.round(t.g),0,255),this.inputFields.b.valueAsNumber=ue(Math.round(t.b),0,255)},n.updateHEXInputField=function(){this.inputFields.hex.value=this.getHEX()},n.validateHueAndSaturation=function(){Number.isNaN(this.hsv.h)?this.hsv.h=this.backUpHue:this.backUpHue=this.hsv.h,Number.isNaN(this.hsv.s)?this.hsv.s=this.backUpSaturation:this.backUpSaturation=this.hsv.s},n.formatHSV=function(t){return pn(t.toString()).formatHex()},t}();function ue(t,n,e){return Math.max(n,Math.min(e,t))}var ce,de,pe=function(){function t(t,n){if(void 0===n&&(n=[{stop:0,rgb:"blue"},{stop:.5,rgb:"white"},{stop:1,rgb:"red"}]),this.container=void 0,this.canvas=void 0,this.ctx=void 0,this.colorRange=void 0,this.colorMap=void 0,this.isDragging=!1,this.dragIndex=-1,this.controlPointSize=7,this.colorPickerContainer=void 0,this.colorPicker=void 0,this.callback=function(){},!t)throw"No element given!";this.container="string"==typeof t?document.querySelector(t):t,this.container.classList.add("tfe-color-map-editor"),this.colorMap=n,this.updateColorRange(),this.canvas=document.createElement("canvas"),this.canvas.width=this.container.clientWidth,this.canvas.height=this.container.clientHeight,this.container.appendChild(this.canvas),this.ctx=this.canvas.getContext("2d",{alpha:!1}),this.colorPickerContainer=document.createElement("div"),this.colorPickerContainer.classList.add("tfe-color-map-editor-color-picker-container"),this.colorPickerContainer.style.width="fit-content",this.colorPickerContainer.style.padding="12px",this.colorPickerContainer.style.backgroundColor="white",this.colorPickerContainer.style.border="1px solid black",this.colorPickerContainer.style.visibility="hidden",this.colorPickerContainer.style.position="relative",this.colorPickerContainer.style.bottom=this.canvas.height/2+"px",this.container.appendChild(this.colorPickerContainer),this.colorPicker=new le(this.colorPickerContainer),this.draw(),this.addEventListeners()}var n=t.prototype;return n.setColorMap=function(t){this.colorMap=t,this.updateColorRange(),this.draw(),this.callback(this.colorMap)},n.getColorMap=function(){return this.colorMap},n.onChange=function(t){this.callback=t,this.callback(this.colorMap)},n.draw=function(){for(var t=0;t<this.canvas.width;++t)this.ctx.fillStyle=this.colorRange(t/(this.canvas.width-1)),this.ctx.fillRect(t,0,1,this.canvas.height);this.ctx.fillStyle="transparent";for(var n=0;n<this.colorMap.length;n++)for(var e=this.colorMap[n].stop*this.canvas.width,i=.5*this.canvas.height,r=0;r<10;r++)this.ctx.beginPath(),this.ctx.strokeStyle=r%2==0?"white":"black",this.ctx.arc(e,i,this.controlPointSize,r/10*(2*Math.PI),(r+1)/10*(2*Math.PI)),this.ctx.stroke()},n.updateColorRange=function(){this.colorRange=$t().domain(this.colorMap.map((function(t){return t.stop}))).range(this.colorMap.map((function(t){return t.rgb}))).interpolate(xn)},n.addEventListeners=function(){var t=this,n=!1,e=function(n){t.dragIndex=-1;for(var e=0;e<t.colorMap.length;e++)if(Math.abs(t.colorMap[e].stop*t.canvas.width-n.offsetX)<t.controlPointSize){t.dragIndex=e,t.isDragging=!0;break}};this.canvas.addEventListener("mousedown",(function(i){if(n=!1,0===i.button&&e(i),!t.isDragging){var r=Math.max(0,Math.min(1,i.offsetX/t.canvas.width));if(0===i.button){var a=t.colorRange(r);t.colorMap.push({stop:r,rgb:a}),t.colorMap.sort((function(t,n){return t.stop-n.stop})),t.updateColorRange(),t.draw(),t.callback(t.colorMap),e(i)}else if(1===i.button){for(var o=-1,s=1;s<t.colorMap.length-1;s++){var h=t.colorMap[s].stop*t.canvas.width-i.offsetX,l=.5*t.canvas.height-i.offsetY;if(Math.sqrt(h*h+l*l)<t.controlPointSize){o=s;break}}-1!==o&&(t.colorMap.splice(o,1),t.updateColorRange(),t.draw(),t.callback(t.colorMap))}}})),this.canvas.addEventListener("mousemove",(function(e){if(t.isDragging&&-1!==t.dragIndex){var i=Math.max(0,Math.min(1,e.offsetX/t.canvas.width));0!==t.dragIndex&&t.dragIndex!==t.colorMap.length-1&&(t.colorMap[t.dragIndex].stop=i),t.colorMap.sort((function(t,n){return t.stop-n.stop})),t.updateColorRange(),t.draw(),t.callback(t.colorMap),n=!0}})),this.canvas.addEventListener("mouseup",(function(n){t.isDragging=!1,t.dragIndex=-1})),this.canvas.addEventListener("mouseleave",(function(n){if(t.isDragging&&-1!==t.dragIndex){var e=Math.max(0+Number.EPSILON,Math.min(1-Number.EPSILON,n.offsetX/t.canvas.width));0!==t.dragIndex&&t.dragIndex!==t.colorMap.length-1&&(t.colorMap[t.dragIndex].stop=e),t.colorMap.sort((function(t,n){return t.stop-n.stop})),t.updateColorRange(),t.draw(),t.callback(t.colorMap),t.isDragging=!1,t.dragIndex=-1}})),this.canvas.addEventListener("click",(function(e){if(!n){e.stopPropagation();for(var i=null,r=0;r<t.colorMap.length;r++){var a=(i=t.colorMap[r]).stop*t.canvas.width-e.offsetX,o=.5*t.canvas.height-e.offsetY;if(Math.sqrt(a*a+o*o)<t.controlPointSize)break}null!==i&&(t.colorPickerContainer.style.left=i.stop*t.canvas.width+"px",t.colorPickerContainer.style.visibility="visible",t.colorPicker.onChange((function(){})),t.colorPicker.setHEX(i.rgb),t.colorPicker.onChange((function(n){i.rgb=n.hex,t.updateColorRange(),t.draw(),t.callback(t.colorMap)})))}})),this.colorPickerContainer.addEventListener("click",(function(t){return t.stopPropagation()})),document.addEventListener("click",(function(){t.colorPickerContainer.style.visibility="hidden"}))},t}(),fe=function(){function t(t,n){if(void 0===n&&(n=[{stop:0,alpha:1},{stop:.5,alpha:.5},{stop:1,alpha:0}]),this.container=void 0,this.canvas=void 0,this.ctx=void 0,this.controlPoints=void 0,this.alphaRange=void 0,this.colorRange=void 0,this.colorMap=[{stop:0,rgb:"black"},{stop:1,rgb:"black"}],this.isDragging=!1,this.dragIndex=-1,this.controlPointSize=7,this.callback=void 0,!t)throw"No element given!";this.container="string"==typeof t?document.querySelector(t):t,this.container.classList.add("tfe-transparency-editor"),this.controlPoints=n,this.canvas=document.createElement("canvas"),this.canvas.width=this.container.clientWidth,this.canvas.height=this.container.clientHeight,this.canvas.style.imageRendering="pixelated",this.container.appendChild(this.canvas),this.ctx=this.canvas.getContext("2d"),this.updateColorRange(),this.updateAlphaRange(),this.draw(),this.addEventListeners()}var n=t.prototype;return n.onChange=function(t){this.callback=t,this.callback(this.getTransferFunction())},n.getTransferFunction=function(){return{alphaStops:this.controlPoints,colorMap:this.colorMap}},n.getRGB=function(t){return this.colorRange(t)},n.getAlpha=function(t){return this.alphaRange(t)},n.getRGBA=function(t){var n=rn(this.getRGB(t)),e=this.getAlpha(t);return n.opacity=1-e,n.formatHex8()},n.addControlPoint=function(t,n){this.controlPoints.push({stop:t,alpha:n}),this.sortControlPoints(),this.updateAlphaRange(),this.sendUpdate(),this.draw()},n.removeControlPointAt=function(t,n){for(var e=-1,i=1;i<this.controlPoints.length-1;i++){var r=this.controlPoints[i],a=r.stop*this.canvas.width-t,o=r.alpha*this.canvas.height-n;if(Math.sqrt(a*a+o*o)<this.controlPointSize){e=i;break}}-1!==e&&(this.controlPoints.splice(e,1),this.updateAlphaRange(),this.sendUpdate(),this.draw())},n.setAlphaStops=function(t){this.controlPoints=t,this.updateAlphaRange(),this.sendUpdate(),this.draw()},n.getAlphaStops=function(){return this.controlPoints},n.setColorMap=function(t){this.colorMap=t,this.updateColorRange(),this.sendUpdate(),this.draw()},n.sendUpdate=function(){this.callback&&this.callback({alphaStops:this.controlPoints,colorMap:this.colorMap})},n.updateColorRange=function(){this.colorRange=$t().domain(this.colorMap.map((function(t){return t.stop}))).range(this.colorMap.map((function(t){return t.rgb}))).interpolate(xn)},n.updateAlphaRange=function(){this.alphaRange=$t().domain(this.controlPoints.map((function(t){return t.stop}))).range(this.controlPoints.map((function(t){return t.alpha}))).interpolate(Mn)},n.draw=function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);for(var t=0;t<this.canvas.width;++t){var n=this.getAlpha(t/(this.canvas.width-1));this.ctx.fillStyle=this.getRGBA(t/(this.canvas.width-1)),this.ctx.fillRect(t,n*this.canvas.height,1,(1-n)*this.canvas.height)}this.ctx.strokeStyle="black",this.ctx.beginPath();for(var e=0;e<this.controlPoints.length;e++){var i=this.controlPoints[e].stop*this.canvas.width,r=this.controlPoints[e].alpha*this.canvas.height;0===e?this.ctx.moveTo(i,r):this.ctx.lineTo(i,r)}this.ctx.stroke(),this.ctx.fillStyle="white";for(var a=0;a<this.controlPoints.length;a++){var o=this.controlPoints[a].stop*this.canvas.width,s=this.controlPoints[a].alpha*this.canvas.height;this.ctx.strokeStyle="black",this.ctx.beginPath(),this.ctx.arc(o,s,this.controlPointSize,0,2*Math.PI),this.ctx.fill(),this.ctx.stroke()}},n.sortControlPoints=function(){this.controlPoints.sort((function(t,n){return t.stop-n.stop}))},n.pixelToNormalized=function(t,n){return{stop:Math.max(0,Math.min(1,t/this.canvas.width)),alpha:Math.max(0,Math.min(1,n/this.canvas.height))}},n.addEventListeners=function(){var t=this,n=function(n){t.dragIndex=-1;for(var e=0;e<t.controlPoints.length;e++){var i=t.controlPoints[e],r=i.stop*t.canvas.width-n.offsetX,a=i.alpha*t.canvas.height-n.offsetY;if(Math.sqrt(r*r+a*a)<t.controlPointSize){t.dragIndex=e,t.isDragging=!0;break}}};this.canvas.addEventListener("mousedown",(function(e){if(0===e.button&&n(e),!t.isDragging)if(0===e.button){var i=t.pixelToNormalized(e.offsetX,e.offsetY);t.addControlPoint(i.stop,i.alpha),n(e)}else 1===e.button&&t.removeControlPointAt(e.offsetX,e.offsetY)})),this.canvas.addEventListener("mousemove",(function(n){if(t.isDragging&&-1!==t.dragIndex){var e=t.pixelToNormalized(n.offsetX,n.offsetY),i=e.alpha;0===t.dragIndex||t.dragIndex===t.controlPoints.length-1||(t.controlPoints[t.dragIndex].stop=e.stop),t.controlPoints[t.dragIndex].alpha=i,t.sortControlPoints(),t.updateAlphaRange(),t.sendUpdate(),t.draw()}})),this.canvas.addEventListener("mouseup",(function(){t.isDragging=!1,t.dragIndex=-1})),this.canvas.addEventListener("mouseleave",(function(n){if(t.isDragging){var e=t.controlPoints[t.dragIndex];n.offsetY<0?e.alpha=0:n.offsetY>t.canvas.height&&(e.alpha=1),n.offsetX<0&&t.dragIndex>0?e.stop=(t.dragIndex+1)*Number.EPSILON:n.offsetX>t.canvas.width&&t.dragIndex<t.controlPoints.length-1&&(e.stop=1-(t.controlPoints.length-t.dragIndex)*Number.EPSILON),t.isDragging=!1,t.dragIndex=-1,t.sortControlPoints(),t.updateAlphaRange(),t.sendUpdate(),t.draw()}}))},t}(),ge=function(){function t(t){var n=this;if(this.container=void 0,this.transparencyEditor=void 0,this.colorMapEditor=void 0,this.callback=null,!t)throw"No element given!";this.container="string"==typeof t?document.querySelector(t):t,this.container.classList.add("tfe-transfer-function-editor");var e=document.createElement("div");e.style.width="100%",e.style.minHeight="50px",this.container.append(e),this.transparencyEditor=new fe(e);var i=document.createElement("div");i.style.width="100%",i.style.minHeight="10px",this.container.append(i),this.colorMapEditor=new pe(i),this.colorMapEditor.onChange((function(t){return n.transparencyEditor.setColorMap(t)})),this.transparencyEditor.setColorMap(this.colorMapEditor.getColorMap()),this.transparencyEditor.onChange((function(t){n.callback&&n.callback(t)}))}var n=t.prototype;return n.onChange=function(t){this.callback=t,this.callback(this.transparencyEditor.getTransferFunction())},n.setAlphaStops=function(t){this.transparencyEditor.setAlphaStops(t)},n.setColorMap=function(t){this.colorMapEditor.setColorMap(t)},n.getAlphaStops=function(){return this.transparencyEditor.getAlphaStops()},n.getColorMap=function(){return this.colorMapEditor.getColorMap()},t}();(de=ce||(ce={})).RGB="RGB",de.HSV="HSV",de.LAB="Lab",de.DIVERGING="Diverging",de.LAB_CIEDE2000="Lab/CIEDE2000",de.STEP="Step";new ge("#tf-editor").onChange((t=>{document.querySelector("#tf-output").innerText=JSON.stringify(t,null,2)}));new fe("#tp").onChange((t=>{document.querySelector("#tp-output").innerText=JSON.stringify(t,null,2)}));new pe("#cm",[{stop:0,rgb:"#0f0"},{stop:.5,rgb:"#f00"},{stop:1,rgb:"#000"}]).onChange((t=>{document.querySelector("#cm-output").innerText=JSON.stringify(t,null,2)}));new le("#cp",{initialColor:"cyan"}).onChange((t=>{document.querySelector("#cp-output").innerText=JSON.stringify(t,null,2)}));
//# sourceMappingURL=index.9b10d814.js.map
